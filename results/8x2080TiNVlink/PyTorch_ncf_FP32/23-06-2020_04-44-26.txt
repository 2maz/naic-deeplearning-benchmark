:::NVLOGv0.1.0 ncf 1592887468.371006012 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1592887468.384833097 (ncf.py:171) mem_info: {"ram": "692G"}
:::NVLOGv0.1.0 ncf 1592887468.389164448 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1592887468.390350103 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1592887468.397401333 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1592887468.399668932 (ncf.py:171) mem_info: {"ram": "692G"}
:::NVLOGv0.1.0 ncf 1592887468.401872158 (ncf.py:171) mem_info: {"ram": "692G"}
:::NVLOGv0.1.0 ncf 1592887468.410217047 (ncf.py:171) mem_info: {"ram": "692G"}
:::NVLOGv0.1.0 ncf 1592887468.424173117 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1592887468.432415962 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1592887468.434499264 (ncf.py:171) mem_info: {"ram": "692G"}
:::NVLOGv0.1.0 ncf 1592887468.436742306 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1592887468.444150686 (ncf.py:171) mem_info: {"ram": "692G"}
:::NVLOGv0.1.0 ncf 1592887468.449050426 (ncf.py:171) mem_info: {"ram": "692G"}
:::NVLOGv0.1.0 ncf 1592887468.501226425 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1592887468.514227629 (ncf.py:171) mem_info: {"ram": "692G"}
:::NVLOGv0.1.0 ncf 1592887472.840180635 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1592887473.055014133 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1592887473.060187817 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1592887473.060788631 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1592887473.168795347 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1592887473.171421528 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1592887473.174591780 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1592887473.273411036 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1592887476.165664911 (ncf.py:174) args: {"data": "/data/ncf/cache/ml-20m", "epochs": 2, "batch_size": 5600000, "valid_batch_size": 1048576, "factors": 64, "layers": [256, 256, 128, 64], "negative_samples": 4, "learning_rate": 0.0045, "topk": 10, "seed": 1, "threshold": 1.0, "beta1": 0.25, "beta2": 0.5, "eps": 1e-08, "dropout": 0.5, "checkpoint_dir": "/data/checkpoints/", "load_checkpoint_path": null, "mode": "train", "grads_accumulated": 1, "opt_level": "O0", "local_rank": 0, "distributed": true, "world_size": 8}
Saving results to /data/checkpoints/
:::NVLOGv0.1.0 ncf 1592887476.167350292 (ncf.py:184) preproc_hp_sample_eval_replacement: true
:::NVLOGv0.1.0 ncf 1592887476.168450356 (ncf.py:185) input_hp_sample_train_replacement: true
:::NVLOGv0.1.0 ncf 1592887476.169474602 (ncf.py:186) input_step_eval_neg_gen
:::NVLOGv0.1.0 ncf 1592887479.788144350 (ncf.py:194) run_start
:::NVLOGv0.1.0 ncf 1592887480.596856833 (ncf.py:201) preproc_hp_num_eval: 100
:::NVLOGv0.1.0 ncf 1592887481.228503704 (ncf.py:207) input_size: 19861770
:::NVLOGv0.1.0 ncf 1592887481.256789684 (ncf.py:216) input_batch_size: 5600000
:::NVLOGv0.1.0 ncf 1592887481.257123947 (ncf.py:217) input_order
:::NVLOGv0.1.0 ncf 1592887481.257922649 (/workspace/examples/ncf/neumf.py:54) model_hp_mf_dim: 64
:::NVLOGv0.1.0 ncf 1592887481.581567049 (/workspace/examples/ncf/neumf.py:62) model_hp_mlp_layer_sizes: [256, 256, 128, 64]
DistributedDataParallel(
  (module): NeuMF(
    (mf_user_embed): Embedding(138493, 64)
    (mf_item_embed): Embedding(26744, 64)
    (mlp_user_embed): Embedding(138493, 128)
    (mlp_item_embed): Embedding(26744, 128)
    (mlp): ModuleList(
      (0): Linear(in_features=256, out_features=256, bias=True)
      (1): Linear(in_features=256, out_features=128, bias=True)
      (2): Linear(in_features=128, out_features=64, bias=True)
    )
    (final): Linear(in_features=128, out_features=1, bias=True)
  )
)
31832577 parameters
:::NVLOGv0.1.0 ncf 1592887482.252377272 (ncf.py:246) opt_learning_rate: 0.0045
:::NVLOGv0.1.0 ncf 1592887482.252756596 (ncf.py:247) opt_name: "Adam"
:::NVLOGv0.1.0 ncf 1592887482.253050327 (ncf.py:248) opt_hp_Adam_beta1: 0.25
:::NVLOGv0.1.0 ncf 1592887482.253333569 (ncf.py:249) opt_hp_Adam_beta2: 0.5
:::NVLOGv0.1.0 ncf 1592887482.253619671 (ncf.py:250) opt_hp_Adam_epsilon: 1e-08
:::NVLOGv0.1.0 ncf 1592887482.253919601 (ncf.py:251) model_hp_loss_fn: "binary_cross_entropy"
:::NVLOGv0.1.0 ncf 1592887482.254195929 (ncf.py:279) train_loop
:::NVLOGv0.1.0 ncf 1592887482.254480362 (ncf.py:282) train_epoch_start: 0
:::NVLOGv0.1.0 ncf 1592887482.254765272 (ncf.py:283) input_hp_num_neg: 4
:::NVLOGv0.1.0 ncf 1592887482.255035639 (ncf.py:284) input_step_train_neg_gen
:::NVLOGv0.1.0 ncf 1592887485.005390644 (ncf.py:318) train_throughput: 36132837.23248434
:::NVLOGv0.1.0 ncf 1592887485.007296562 (ncf.py:319) train_epoch_stop: 0
:::NVLOGv0.1.0 ncf 1592887485.008395195 (ncf.py:320) eval_start: 0
../aten/src/ATen/native/IndexingUtils.h:20: UserWarning: indexing with dtype torch.uint8 is now deprecated, please use a dtype torch.bool instead.
:::NVLOGv0.1.0 ncf 1592887485.128821135 (ncf.py:155) eval_size: {"epoch": 0, "value": 13987793}
:::NVLOGv0.1.0 ncf 1592887485.129339933 (ncf.py:156) eval_hp_num_users: 138493
:::NVLOGv0.1.0 ncf 1592887485.129816294 (ncf.py:157) eval_hp_num_neg: 100
/opt/conda/lib/python3.6/site-packages/torch/distributed/distributed_c10d.py:101: UserWarning: torch.distributed.reduce_op is deprecated, please use torch.distributed.ReduceOp instead
  warnings.warn("torch.distributed.reduce_op is deprecated, please use "
Epoch 0: HR@10 = 0.8341, NDCG@10 = 0.5483, train_time = 2.75, val_time = 0.13
:::NVLOGv0.1.0 ncf 1592887485.134583235 (ncf.py:333) eval_accuracy: {"epoch": 0, "value": 0.8340854772443372}
:::NVLOGv0.1.0 ncf 1592887485.135055542 (ncf.py:334) eval_target: 1.0
:::NVLOGv0.1.0 ncf 1592887485.135465384 (ncf.py:335) eval_stop: 0
:::NVLOGv0.1.0 ncf 1592887485.135876417 (ncf.py:340) eval_throughput: 107100972.8712212
New best hr! Saving the model to:  /data/checkpoints/model.pth
:::NVLOGv0.1.0 ncf 1592887485.370618820 (ncf.py:282) train_epoch_start: 1
:::NVLOGv0.1.0 ncf 1592887485.371113300 (ncf.py:283) input_hp_num_neg: 4
:::NVLOGv0.1.0 ncf 1592887485.371510506 (ncf.py:284) input_step_train_neg_gen
:::NVLOGv0.1.0 ncf 1592887487.632873058 (ncf.py:318) train_throughput: 43955797.08735989
:::NVLOGv0.1.0 ncf 1592887487.634577036 (ncf.py:319) train_epoch_stop: 1
:::NVLOGv0.1.0 ncf 1592887487.635715246 (ncf.py:320) eval_start: 1
../aten/src/ATen/native/IndexingUtils.h:20: UserWarning: indexing with dtype torch.uint8 is now deprecated, please use a dtype torch.bool instead.
:::NVLOGv0.1.0 ncf 1592887487.753313780 (ncf.py:155) eval_size: {"epoch": 1, "value": 13987793}
:::NVLOGv0.1.0 ncf 1592887487.753859758 (ncf.py:156) eval_hp_num_users: 138493
:::NVLOGv0.1.0 ncf 1592887487.754338503 (ncf.py:157) eval_hp_num_neg: 100
Epoch 1: HR@10 = 0.8400, NDCG@10 = 0.5579, train_time = 2.26, val_time = 0.12
:::NVLOGv0.1.0 ncf 1592887487.755481482 (ncf.py:333) eval_accuracy: {"epoch": 1, "value": 0.8400207952748514}
:::NVLOGv0.1.0 ncf 1592887487.755928516 (ncf.py:334) eval_target: 1.0
:::NVLOGv0.1.0 ncf 1592887487.756347895 (ncf.py:335) eval_stop: 1
:::NVLOGv0.1.0 ncf 1592887487.756767988 (ncf.py:340) eval_throughput: 112664777.29975036
New best hr! Saving the model to:  /data/checkpoints/model.pth
:::NVLOGv0.1.0 ncf 1592887487.988087654 (ncf.py:356) best_train_throughput: 43955797.08735989
:::NVLOGv0.1.0 ncf 1592887487.988492012 (ncf.py:357) best_eval_throughput: 112664777.29975036
:::NVLOGv0.1.0 ncf 1592887487.988800764 (ncf.py:358) best_accuracy: 0.8400207952748514
:::NVLOGv0.1.0 ncf 1592887487.989074945 (ncf.py:359) time_to_target: 8.201164960861206
:::NVLOGv0.1.0 ncf 1592887487.989330292 (ncf.py:360) time_to_best_model: 8.199952125549316
:::NVLOGv0.1.0 ncf 1592887487.989635468 (ncf.py:362) run_stop: {"success": false}
:::NVLOGv0.1.0 ncf 1592887487.989942312 (ncf.py:363) run_final
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
DONE!
