=> creating model '('resnet50', 'classic')'
Version: {'net': <class 'image_classification.resnet.ResNet'>, 'block': <class 'image_classification.resnet.Bottleneck'>, 'layers': [3, 4, 6, 3], 'widths': [64, 128, 256, 512], 'expansion': 4, 'num_classes': 1000}
Config: {'conv': <class 'torch.nn.modules.conv.Conv2d'>, 'conv_init': 'fan_out', 'nonlinearity': 'relu', 'last_bn_0_init': False, 'activation': <function <lambda> at 0x7fb45ff2d840>}
read 1281167 files from 1000 directories
read 50000 files from 1000 directories
DLL 2020-03-05 20:59:27.822299 - PARAMETER data : /data/imagenet  data_backend : dali-cpu  arch : resnet50  model_config : classic  workers : 5  epochs : 1  batch_size : 928  optimizer_batch_size : -1  lr : 0.1  lr_schedule : step  warmup : 0  label_smoothing : 0.0  mixup : 0.0  momentum : 0.9  weight_decay : 0.0001  bn_weight_decay : False  nesterov : False  print_freq : 1  resume :   pretrained_weights :   fp16 : True  static_loss_scale : 256.0  dynamic_loss_scale : False  prof : 100  amp : False  seed : None  gather_checkpoints : False  raport_file : benchmark.json  evaluate : False  training_only : True  save_checkpoints : True  workspace : ./  distributed : False  local_rank : 0  gpu : 0  world_size : 1 
 ! Weight decay NOT applied to BN parameters 
98
63
Warning:  FP16_Optimizer is deprecated and dangerous, and will be deleted soon.  If it still works, you're probably getting lucky.  For mixed precision, use the documented API https://nvidia.github.io/apex/amp.html, with opt_level=O1.
DLL 2020-03-05 21:00:00.933321 - Epoch: 0 Iteration: 1  train.loss : 7.07422  train.total_ips : 28.10 img/s
DLL 2020-03-05 21:00:03.344877 - Epoch: 0 Iteration: 2  train.loss : 7.11328  train.total_ips : 384.83 img/s
DLL 2020-03-05 21:00:05.923981 - Epoch: 0 Iteration: 3  train.loss : 7.08594  train.total_ips : 359.83 img/s
DLL 2020-03-05 21:00:08.137189 - Epoch: 0 Iteration: 4  train.loss : 7.16797  train.total_ips : 419.32 img/s
DLL 2020-03-05 21:00:10.776814 - Epoch: 0 Iteration: 5  train.loss : 7.26953  train.total_ips : 351.58 img/s
DLL 2020-03-05 21:00:13.267488 - Epoch: 0 Iteration: 6  train.loss : 7.22656  train.total_ips : 372.60 img/s
DLL 2020-03-05 21:00:15.865227 - Epoch: 0 Iteration: 7  train.loss : 7.35938  train.total_ips : 357.25 img/s
DLL 2020-03-05 21:00:18.181694 - Epoch: 0 Iteration: 8  train.loss : 7.35938  train.total_ips : 400.63 img/s
DLL 2020-03-05 21:00:20.602743 - Epoch: 0 Iteration: 9  train.loss : 7.41406  train.total_ips : 383.32 img/s
DLL 2020-03-05 21:00:23.109790 - Epoch: 0 Iteration: 10  train.loss : 7.35938  train.total_ips : 370.17 img/s
DLL 2020-03-05 21:00:25.541695 - Epoch: 0 Iteration: 11  train.loss : 7.62891  train.total_ips : 381.61 img/s
DLL 2020-03-05 21:00:27.669104 - Epoch: 0 Iteration: 12  train.loss : 7.39062  train.total_ips : 436.23 img/s
DLL 2020-03-05 21:00:30.248680 - Epoch: 0 Iteration: 13  train.loss : 7.60156  train.total_ips : 359.76 img/s
DLL 2020-03-05 21:00:32.950403 - Epoch: 0 Iteration: 14  train.loss : 7.33594  train.total_ips : 343.50 img/s
DLL 2020-03-05 21:00:35.389164 - Epoch: 0 Iteration: 15  train.loss : 7.71094  train.total_ips : 380.53 img/s
DLL 2020-03-05 21:00:37.901878 - Epoch: 0 Iteration: 16  train.loss : 7.38281  train.total_ips : 369.34 img/s
DLL 2020-03-05 21:00:40.066645 - Epoch: 0 Iteration: 17  train.loss : 7.95703  train.total_ips : 428.70 img/s
DLL 2020-03-05 21:00:42.320558 - Epoch: 0 Iteration: 18  train.loss : 7.32812  train.total_ips : 411.75 img/s
DLL 2020-03-05 21:00:44.688671 - Epoch: 0 Iteration: 19  train.loss : 7.28125  train.total_ips : 391.89 img/s
DLL 2020-03-05 21:00:47.297550 - Epoch: 0 Iteration: 20  train.loss : 7.66406  train.total_ips : 355.72 img/s
DLL 2020-03-05 21:00:49.590240 - Epoch: 0 Iteration: 21  train.loss : 7.31641  train.total_ips : 404.78 img/s
DLL 2020-03-05 21:00:51.793370 - Epoch: 0 Iteration: 22  train.loss : 7.15234  train.total_ips : 421.24 img/s
DLL 2020-03-05 21:00:54.481632 - Epoch: 0 Iteration: 23  train.loss : 7.17578  train.total_ips : 345.22 img/s
DLL 2020-03-05 21:00:56.708778 - Epoch: 0 Iteration: 24  train.loss : 7.23828  train.total_ips : 416.69 img/s
DLL 2020-03-05 21:00:59.300344 - Epoch: 0 Iteration: 25  train.loss : 7.19531  train.total_ips : 358.10 img/s
DLL 2020-03-05 21:01:01.388220 - Epoch: 0 Iteration: 26  train.loss : 7.10938  train.total_ips : 444.49 img/s
DLL 2020-03-05 21:01:03.906959 - Epoch: 0 Iteration: 27  train.loss : 7.15625  train.total_ips : 368.45 img/s
DLL 2020-03-05 21:01:06.119318 - Epoch: 0 Iteration: 28  train.loss : 7.14062  train.total_ips : 419.48 img/s
DLL 2020-03-05 21:01:08.559234 - Epoch: 0 Iteration: 29  train.loss : 7.37500  train.total_ips : 380.36 img/s
DLL 2020-03-05 21:01:10.726137 - Epoch: 0 Iteration: 30  train.loss : 7.45312  train.total_ips : 428.28 img/s
DLL 2020-03-05 21:01:12.910948 - Epoch: 0 Iteration: 31  train.loss : 7.25000  train.total_ips : 424.77 img/s
DLL 2020-03-05 21:01:15.024028 - Epoch: 0 Iteration: 32  train.loss : 7.32812  train.total_ips : 439.19 img/s
DLL 2020-03-05 21:01:17.197323 - Epoch: 0 Iteration: 33  train.loss : 7.21094  train.total_ips : 427.02 img/s
DLL 2020-03-05 21:01:19.417952 - Epoch: 0 Iteration: 34  train.loss : 7.17188  train.total_ips : 417.92 img/s
DLL 2020-03-05 21:01:21.455524 - Epoch: 0 Iteration: 35  train.loss : 7.07812  train.total_ips : 455.46 img/s
DLL 2020-03-05 21:01:23.534989 - Epoch: 0 Iteration: 36  train.loss : 7.03125  train.total_ips : 446.29 img/s
DLL 2020-03-05 21:01:25.906427 - Epoch: 0 Iteration: 37  train.loss : 7.04297  train.total_ips : 391.34 img/s
DLL 2020-03-05 21:01:27.980201 - Epoch: 0 Iteration: 38  train.loss : 7.02734  train.total_ips : 447.51 img/s
DLL 2020-03-05 21:01:30.150320 - Epoch: 0 Iteration: 39  train.loss : 6.99219  train.total_ips : 427.65 img/s
DLL 2020-03-05 21:01:32.546087 - Epoch: 0 Iteration: 40  train.loss : 7.03125  train.total_ips : 387.37 img/s
DLL 2020-03-05 21:01:35.102320 - Epoch: 0 Iteration: 41  train.loss : 7.03516  train.total_ips : 363.05 img/s
DLL 2020-03-05 21:01:37.332583 - Epoch: 0 Iteration: 42  train.loss : 7.06641  train.total_ips : 416.11 img/s
DLL 2020-03-05 21:01:39.531520 - Epoch: 0 Iteration: 43  train.loss : 7.15234  train.total_ips : 422.04 img/s
DLL 2020-03-05 21:01:41.786702 - Epoch: 0 Iteration: 44  train.loss : 7.07031  train.total_ips : 411.51 img/s
DLL 2020-03-05 21:01:44.155744 - Epoch: 0 Iteration: 45  train.loss : 7.10547  train.total_ips : 391.74 img/s
DLL 2020-03-05 21:01:46.383932 - Epoch: 0 Iteration: 46  train.loss : 6.96875  train.total_ips : 416.50 img/s
DLL 2020-03-05 21:01:48.571341 - Epoch: 0 Iteration: 47  train.loss : 6.97656  train.total_ips : 424.26 img/s
DLL 2020-03-05 21:01:50.598045 - Epoch: 0 Iteration: 48  train.loss : 6.93750  train.total_ips : 457.91 img/s
DLL 2020-03-05 21:01:52.756201 - Epoch: 0 Iteration: 49  train.loss : 7.01562  train.total_ips : 430.02 img/s
DLL 2020-03-05 21:01:55.177525 - Epoch: 0 Iteration: 50  train.loss : 7.05469  train.total_ips : 383.28 img/s
DLL 2020-03-05 21:01:57.249666 - Epoch: 0 Iteration: 51  train.loss : 6.94531  train.total_ips : 447.87 img/s
DLL 2020-03-05 21:01:59.829777 - Epoch: 0 Iteration: 52  train.loss : 6.98438  train.total_ips : 359.69 img/s
DLL 2020-03-05 21:02:02.023651 - Epoch: 0 Iteration: 53  train.loss : 6.94531  train.total_ips : 423.01 img/s
DLL 2020-03-05 21:02:04.529373 - Epoch: 0 Iteration: 54  train.loss : 6.98438  train.total_ips : 370.37 img/s
DLL 2020-03-05 21:02:06.736114 - Epoch: 0 Iteration: 55  train.loss : 7.04297  train.total_ips : 420.55 img/s
DLL 2020-03-05 21:02:09.219395 - Epoch: 0 Iteration: 56  train.loss : 6.96484  train.total_ips : 373.71 img/s
DLL 2020-03-05 21:02:11.183078 - Epoch: 0 Iteration: 57  train.loss : 6.93750  train.total_ips : 472.61 img/s
DLL 2020-03-05 21:02:12.907602 - Epoch: 0 Iteration: 58  train.loss : 6.95703  train.total_ips : 538.15 img/s
DLL 2020-03-05 21:02:15.029649 - Epoch: 0 Iteration: 59  train.loss : 6.93359  train.total_ips : 437.33 img/s
DLL 2020-03-05 21:02:17.106387 - Epoch: 0 Iteration: 60  train.loss : 6.92188  train.total_ips : 446.88 img/s
DLL 2020-03-05 21:02:19.369541 - Epoch: 0 Iteration: 61  train.loss : 6.95703  train.total_ips : 410.06 img/s
DLL 2020-03-05 21:02:22.090872 - Epoch: 0 Iteration: 62  train.loss : 6.94531  train.total_ips : 341.02 img/s
DLL 2020-03-05 21:02:24.269899 - Epoch: 0 Iteration: 63  train.loss : 6.92578  train.total_ips : 425.90 img/s
DLL 2020-03-05 21:02:26.595965 - Epoch: 0 Iteration: 64  train.loss : 6.94922  train.total_ips : 398.97 img/s
DLL 2020-03-05 21:02:29.591323 - Epoch: 0 Iteration: 65  train.loss : 6.91797  train.total_ips : 309.82 img/s
DLL 2020-03-05 21:02:33.326733 - Epoch: 0 Iteration: 66  train.loss : 6.96484  train.total_ips : 248.44 img/s
DLL 2020-03-05 21:02:36.468892 - Epoch: 0 Iteration: 67  train.loss : 6.92969  train.total_ips : 295.35 img/s
DLL 2020-03-05 21:02:39.337456 - Epoch: 0 Iteration: 68  train.loss : 6.92969  train.total_ips : 323.52 img/s
DLL 2020-03-05 21:02:41.910783 - Epoch: 0 Iteration: 69  train.loss : 6.93750  train.total_ips : 360.64 img/s
DLL 2020-03-05 21:02:44.651836 - Epoch: 0 Iteration: 70  train.loss : 7.00000  train.total_ips : 338.57 img/s
DLL 2020-03-05 21:02:47.093057 - Epoch: 0 Iteration: 71  train.loss : 6.92188  train.total_ips : 380.15 img/s
DLL 2020-03-05 21:02:49.635703 - Epoch: 0 Iteration: 72  train.loss : 6.92578  train.total_ips : 364.99 img/s
DLL 2020-03-05 21:02:51.949434 - Epoch: 0 Iteration: 73  train.loss : 6.92578  train.total_ips : 401.10 img/s
DLL 2020-03-05 21:02:55.280351 - Epoch: 0 Iteration: 74  train.loss : 6.92578  train.total_ips : 278.61 img/s
DLL 2020-03-05 21:02:58.236342 - Epoch: 0 Iteration: 75  train.loss : 6.96875  train.total_ips : 313.95 img/s
DLL 2020-03-05 21:03:01.332424 - Epoch: 0 Iteration: 76  train.loss : 6.89844  train.total_ips : 299.74 img/s
DLL 2020-03-05 21:03:04.763328 - Epoch: 0 Iteration: 77  train.loss : 6.91016  train.total_ips : 270.49 img/s
DLL 2020-03-05 21:03:08.410123 - Epoch: 0 Iteration: 78  train.loss : 6.93750  train.total_ips : 254.48 img/s
DLL 2020-03-05 21:03:11.924434 - Epoch: 0 Iteration: 79  train.loss : 6.93359  train.total_ips : 264.07 img/s
DLL 2020-03-05 21:03:15.153847 - Epoch: 0 Iteration: 80  train.loss : 6.91797  train.total_ips : 287.37 img/s
DLL 2020-03-05 21:03:18.976146 - Epoch: 0 Iteration: 81  train.loss : 6.91016  train.total_ips : 242.79 img/s
DLL 2020-03-05 21:03:22.448730 - Epoch: 0 Iteration: 82  train.loss : 6.92188  train.total_ips : 267.24 img/s
DLL 2020-03-05 21:03:25.369126 - Epoch: 0 Iteration: 83  train.loss : 6.90234  train.total_ips : 317.78 img/s
DLL 2020-03-05 21:03:27.975564 - Epoch: 0 Iteration: 84  train.loss : 6.92578  train.total_ips : 356.05 img/s
DLL 2020-03-05 21:03:30.121969 - Epoch: 0 Iteration: 85  train.loss : 6.89453  train.total_ips : 432.37 img/s
DLL 2020-03-05 21:03:32.367347 - Epoch: 0 Iteration: 86  train.loss : 6.91797  train.total_ips : 413.31 img/s
DLL 2020-03-05 21:03:34.667511 - Epoch: 0 Iteration: 87  train.loss : 6.89062  train.total_ips : 403.47 img/s
DLL 2020-03-05 21:03:37.067492 - Epoch: 0 Iteration: 88  train.loss : 6.89062  train.total_ips : 386.68 img/s
DLL 2020-03-05 21:03:40.854833 - Epoch: 0 Iteration: 89  train.loss : 6.90625  train.total_ips : 245.03 img/s
DLL 2020-03-05 21:03:44.804027 - Epoch: 0 Iteration: 90  train.loss : 6.90625  train.total_ips : 234.99 img/s
DLL 2020-03-05 21:03:48.374935 - Epoch: 0 Iteration: 91  train.loss : 6.91406  train.total_ips : 259.88 img/s
DLL 2020-03-05 21:03:51.848133 - Epoch: 0 Iteration: 92  train.loss : 6.90234  train.total_ips : 267.20 img/s
DLL 2020-03-05 21:03:56.003788 - Epoch: 0 Iteration: 93  train.loss : 6.90625  train.total_ips : 223.32 img/s
DLL 2020-03-05 21:03:59.976592 - Epoch: 0 Iteration: 94  train.loss : 6.90625  train.total_ips : 233.59 img/s
DLL 2020-03-05 21:04:03.653075 - Epoch: 0 Iteration: 95  train.loss : 6.90234  train.total_ips : 252.42 img/s
DLL 2020-03-05 21:04:07.345164 - Epoch: 0 Iteration: 96  train.loss : 6.91016  train.total_ips : 251.35 img/s
DLL 2020-03-05 21:04:10.035537 - Epoch: 0 Iteration: 97  train.loss : 6.91016  train.total_ips : 344.95 img/s
DLL 2020-03-05 21:04:12.438361 - Epoch: 0 Iteration: 98  train.loss : 6.91797  train.total_ips : 386.23 img/s
DLL 2020-03-05 21:04:14.554456 - Epoch: 0 Iteration: 99  train.loss : 6.92188  train.total_ips : 438.56 img/s
DLL 2020-03-05 21:04:17.181999 - Epoch: 0  train.loss : 7.08074  train.total_ips : 368.22 img/s
DLL 2020-03-05 21:04:17.182130 - Epoch: 0  lr : 0.1  train.compute_ips : 368.82 img/s train.data_time : 0.00458 s train.compute_time : 2.88805 s
SAVING ./checkpoint.pth.tar
DLL 2020-03-05 21:04:18.280871 - Summary: train.loss : 7.08074  train.total_ips : 368.22 img/s
DLL 2020-03-05 21:04:18.281108 - Summary: lr : 0.1  train.compute_ips : 368.82 img/s train.data_time : 0.00458 s train.compute_time : 2.88805 s
Experiment ended
['/opt/conda/bin/python', '-u', './main.py', '/data/imagenet', '--arch', 'resnet50', '--fp16', '--static-loss-scale', '256', '--epochs', '1', '--prof', '100', '--batch-size', '928', '--raport-file', 'benchmark.json', '--print-freq', '1', '--training-only']
DONE!
