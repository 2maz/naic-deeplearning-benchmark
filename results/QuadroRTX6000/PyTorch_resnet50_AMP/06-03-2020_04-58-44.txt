Warning:  if --fp16 is not used, static_loss_scale will be ignored.
=> creating model '('resnet50', 'classic')'
Version: {'net': <class 'image_classification.resnet.ResNet'>, 'block': <class 'image_classification.resnet.Bottleneck'>, 'layers': [3, 4, 6, 3], 'widths': [64, 128, 256, 512], 'expansion': 4, 'num_classes': 1000}
Config: {'conv': <class 'torch.nn.modules.conv.Conv2d'>, 'conv_init': 'fan_out', 'nonlinearity': 'relu', 'last_bn_0_init': False, 'activation': <function <lambda> at 0x7f1c7695d840>}
read 1281167 files from 1000 directories
read 50000 files from 1000 directories
DLL 2020-03-06 04:58:50.967845 - PARAMETER data : /data/imagenet  data_backend : dali-cpu  arch : resnet50  model_config : classic  workers : 5  epochs : 1  batch_size : 448  optimizer_batch_size : -1  lr : 0.1  lr_schedule : step  warmup : 0  label_smoothing : 0.0  mixup : 0.0  momentum : 0.9  weight_decay : 0.0001  bn_weight_decay : False  nesterov : False  print_freq : 1  resume :   pretrained_weights :   fp16 : False  static_loss_scale : 256.0  dynamic_loss_scale : False  prof : 100  amp : True  seed : None  gather_checkpoints : False  raport_file : benchmark.json  evaluate : False  training_only : True  save_checkpoints : True  workspace : ./  distributed : False  local_rank : 0  gpu : 0  world_size : 1 
 ! Weight decay NOT applied to BN parameters 
98
63
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : 256.0
DLL 2020-03-06 04:59:01.257198 - Epoch: 0 Iteration: 1  train.loss : 7.09375  train.total_ips : 43.59 img/s
DLL 2020-03-06 04:59:02.044045 - Epoch: 0 Iteration: 2  train.loss : 7.13281  train.total_ips : 569.40 img/s
DLL 2020-03-06 04:59:02.732127 - Epoch: 0 Iteration: 3  train.loss : 7.40625  train.total_ips : 651.15 img/s
DLL 2020-03-06 04:59:03.420776 - Epoch: 0 Iteration: 4  train.loss : 7.56641  train.total_ips : 650.62 img/s
DLL 2020-03-06 04:59:04.108755 - Epoch: 0 Iteration: 5  train.loss : 7.57422  train.total_ips : 651.25 img/s
DLL 2020-03-06 04:59:04.798252 - Epoch: 0 Iteration: 6  train.loss : 7.57422  train.total_ips : 649.82 img/s
DLL 2020-03-06 04:59:05.487278 - Epoch: 0 Iteration: 7  train.loss : 7.64453  train.total_ips : 650.25 img/s
DLL 2020-03-06 04:59:06.175657 - Epoch: 0 Iteration: 8  train.loss : 7.96484  train.total_ips : 650.87 img/s
DLL 2020-03-06 04:59:06.865070 - Epoch: 0 Iteration: 9  train.loss : 7.73438  train.total_ips : 649.89 img/s
DLL 2020-03-06 04:59:07.552894 - Epoch: 0 Iteration: 10  train.loss : 7.78516  train.total_ips : 651.40 img/s
DLL 2020-03-06 04:59:08.241896 - Epoch: 0 Iteration: 11  train.loss : 8.49219  train.total_ips : 650.29 img/s
DLL 2020-03-06 04:59:08.931707 - Epoch: 0 Iteration: 12  train.loss : 7.98828  train.total_ips : 649.51 img/s
DLL 2020-03-06 04:59:09.619963 - Epoch: 0 Iteration: 13  train.loss : 9.05469  train.total_ips : 650.98 img/s
DLL 2020-03-06 04:59:10.309501 - Epoch: 0 Iteration: 14  train.loss : 9.33594  train.total_ips : 649.79 img/s
DLL 2020-03-06 04:59:10.997907 - Epoch: 0 Iteration: 15  train.loss : 9.32031  train.total_ips : 650.84 img/s
DLL 2020-03-06 04:59:11.686964 - Epoch: 0 Iteration: 16  train.loss : 8.10156  train.total_ips : 650.22 img/s
DLL 2020-03-06 04:59:12.376307 - Epoch: 0 Iteration: 17  train.loss : 9.41406  train.total_ips : 649.96 img/s
DLL 2020-03-06 04:59:13.065805 - Epoch: 0 Iteration: 18  train.loss : 7.79688  train.total_ips : 649.81 img/s
DLL 2020-03-06 04:59:13.755587 - Epoch: 0 Iteration: 19  train.loss : 7.55859  train.total_ips : 649.54 img/s
DLL 2020-03-06 04:59:14.444593 - Epoch: 0 Iteration: 20  train.loss : 7.50391  train.total_ips : 650.27 img/s
DLL 2020-03-06 04:59:15.133667 - Epoch: 0 Iteration: 21  train.loss : 7.76172  train.total_ips : 650.21 img/s
DLL 2020-03-06 04:59:15.822470 - Epoch: 0 Iteration: 22  train.loss : 7.57812  train.total_ips : 650.47 img/s
DLL 2020-03-06 04:59:16.511283 - Epoch: 0 Iteration: 23  train.loss : 7.64844  train.total_ips : 650.46 img/s
DLL 2020-03-06 04:59:17.199299 - Epoch: 0 Iteration: 24  train.loss : 7.70703  train.total_ips : 651.22 img/s
DLL 2020-03-06 04:59:17.888075 - Epoch: 0 Iteration: 25  train.loss : 7.63672  train.total_ips : 650.49 img/s
DLL 2020-03-06 04:59:18.576608 - Epoch: 0 Iteration: 26  train.loss : 7.36328  train.total_ips : 650.72 img/s
DLL 2020-03-06 04:59:19.264513 - Epoch: 0 Iteration: 27  train.loss : 7.18359  train.total_ips : 651.33 img/s
DLL 2020-03-06 04:59:19.953191 - Epoch: 0 Iteration: 28  train.loss : 7.24609  train.total_ips : 650.59 img/s
DLL 2020-03-06 04:59:20.641298 - Epoch: 0 Iteration: 29  train.loss : 7.33203  train.total_ips : 651.13 img/s
DLL 2020-03-06 04:59:21.328814 - Epoch: 0 Iteration: 30  train.loss : 7.45703  train.total_ips : 651.69 img/s
DLL 2020-03-06 04:59:22.017444 - Epoch: 0 Iteration: 31  train.loss : 7.07031  train.total_ips : 650.64 img/s
DLL 2020-03-06 04:59:22.705997 - Epoch: 0 Iteration: 32  train.loss : 7.18750  train.total_ips : 650.70 img/s
DLL 2020-03-06 04:59:23.395512 - Epoch: 0 Iteration: 33  train.loss : 7.10156  train.total_ips : 649.80 img/s
DLL 2020-03-06 04:59:24.083586 - Epoch: 0 Iteration: 34  train.loss : 7.00781  train.total_ips : 651.15 img/s
DLL 2020-03-06 04:59:24.771735 - Epoch: 0 Iteration: 35  train.loss : 7.20703  train.total_ips : 651.08 img/s
DLL 2020-03-06 04:59:25.459586 - Epoch: 0 Iteration: 36  train.loss : 7.00000  train.total_ips : 651.38 img/s
DLL 2020-03-06 04:59:26.147844 - Epoch: 0 Iteration: 37  train.loss : 7.03516  train.total_ips : 650.98 img/s
DLL 2020-03-06 04:59:26.836067 - Epoch: 0 Iteration: 38  train.loss : 7.21094  train.total_ips : 651.02 img/s
DLL 2020-03-06 04:59:27.524343 - Epoch: 0 Iteration: 39  train.loss : 7.82422  train.total_ips : 650.97 img/s
DLL 2020-03-06 04:59:28.212390 - Epoch: 0 Iteration: 40  train.loss : 7.13672  train.total_ips : 651.20 img/s
DLL 2020-03-06 04:59:28.901242 - Epoch: 0 Iteration: 41  train.loss : 7.06641  train.total_ips : 650.42 img/s
DLL 2020-03-06 04:59:29.590094 - Epoch: 0 Iteration: 42  train.loss : 7.13672  train.total_ips : 650.45 img/s
DLL 2020-03-06 04:59:30.278534 - Epoch: 0 Iteration: 43  train.loss : 6.96875  train.total_ips : 650.82 img/s
DLL 2020-03-06 04:59:30.967495 - Epoch: 0 Iteration: 44  train.loss : 6.99219  train.total_ips : 650.31 img/s
DLL 2020-03-06 04:59:31.655177 - Epoch: 0 Iteration: 45  train.loss : 6.99609  train.total_ips : 651.53 img/s
DLL 2020-03-06 04:59:32.344752 - Epoch: 0 Iteration: 46  train.loss : 7.02734  train.total_ips : 649.75 img/s
DLL 2020-03-06 04:59:33.032911 - Epoch: 0 Iteration: 47  train.loss : 6.96875  train.total_ips : 651.08 img/s
DLL 2020-03-06 04:59:33.722112 - Epoch: 0 Iteration: 48  train.loss : 7.10938  train.total_ips : 650.09 img/s
DLL 2020-03-06 04:59:34.411059 - Epoch: 0 Iteration: 49  train.loss : 6.95703  train.total_ips : 650.34 img/s
DLL 2020-03-06 04:59:35.100843 - Epoch: 0 Iteration: 50  train.loss : 6.99219  train.total_ips : 649.55 img/s
DLL 2020-03-06 04:59:35.790363 - Epoch: 0 Iteration: 51  train.loss : 6.98047  train.total_ips : 649.79 img/s
DLL 2020-03-06 04:59:36.479686 - Epoch: 0 Iteration: 52  train.loss : 6.93750  train.total_ips : 649.98 img/s
DLL 2020-03-06 04:59:37.169808 - Epoch: 0 Iteration: 53  train.loss : 6.98438  train.total_ips : 649.24 img/s
DLL 2020-03-06 04:59:37.859468 - Epoch: 0 Iteration: 54  train.loss : 6.94531  train.total_ips : 649.66 img/s
DLL 2020-03-06 04:59:38.549751 - Epoch: 0 Iteration: 55  train.loss : 6.99219  train.total_ips : 649.07 img/s
DLL 2020-03-06 04:59:39.239380 - Epoch: 0 Iteration: 56  train.loss : 6.98828  train.total_ips : 649.70 img/s
DLL 2020-03-06 04:59:39.929311 - Epoch: 0 Iteration: 57  train.loss : 6.92188  train.total_ips : 649.40 img/s
DLL 2020-03-06 04:59:40.618562 - Epoch: 0 Iteration: 58  train.loss : 6.92188  train.total_ips : 650.04 img/s
DLL 2020-03-06 04:59:41.308563 - Epoch: 0 Iteration: 59  train.loss : 6.92188  train.total_ips : 649.36 img/s
DLL 2020-03-06 04:59:41.998457 - Epoch: 0 Iteration: 60  train.loss : 6.98047  train.total_ips : 649.44 img/s
DLL 2020-03-06 04:59:42.688330 - Epoch: 0 Iteration: 61  train.loss : 6.91797  train.total_ips : 649.46 img/s
DLL 2020-03-06 04:59:43.377708 - Epoch: 0 Iteration: 62  train.loss : 6.92969  train.total_ips : 649.93 img/s
DLL 2020-03-06 04:59:44.067603 - Epoch: 0 Iteration: 63  train.loss : 6.94141  train.total_ips : 649.43 img/s
DLL 2020-03-06 04:59:44.758045 - Epoch: 0 Iteration: 64  train.loss : 6.94141  train.total_ips : 648.94 img/s
DLL 2020-03-06 04:59:45.446993 - Epoch: 0 Iteration: 65  train.loss : 6.95703  train.total_ips : 650.33 img/s
DLL 2020-03-06 04:59:46.137538 - Epoch: 0 Iteration: 66  train.loss : 6.92969  train.total_ips : 648.83 img/s
DLL 2020-03-06 04:59:46.827233 - Epoch: 0 Iteration: 67  train.loss : 6.91797  train.total_ips : 649.63 img/s
DLL 2020-03-06 04:59:47.516441 - Epoch: 0 Iteration: 68  train.loss : 6.90625  train.total_ips : 650.08 img/s
DLL 2020-03-06 04:59:48.206686 - Epoch: 0 Iteration: 69  train.loss : 6.91797  train.total_ips : 649.12 img/s
DLL 2020-03-06 04:59:48.895476 - Epoch: 0 Iteration: 70  train.loss : 6.92969  train.total_ips : 650.47 img/s
DLL 2020-03-06 04:59:49.585455 - Epoch: 0 Iteration: 71  train.loss : 6.92188  train.total_ips : 649.37 img/s
DLL 2020-03-06 04:59:50.274547 - Epoch: 0 Iteration: 72  train.loss : 6.92578  train.total_ips : 650.22 img/s
DLL 2020-03-06 04:59:50.964212 - Epoch: 0 Iteration: 73  train.loss : 6.92969  train.total_ips : 649.65 img/s
DLL 2020-03-06 04:59:51.653283 - Epoch: 0 Iteration: 74  train.loss : 6.93359  train.total_ips : 650.22 img/s
DLL 2020-03-06 04:59:52.343370 - Epoch: 0 Iteration: 75  train.loss : 6.90234  train.total_ips : 649.27 img/s
DLL 2020-03-06 04:59:53.033372 - Epoch: 0 Iteration: 76  train.loss : 7.14844  train.total_ips : 649.33 img/s
DLL 2020-03-06 04:59:53.723291 - Epoch: 0 Iteration: 77  train.loss : 6.91797  train.total_ips : 649.41 img/s
DLL 2020-03-06 04:59:54.413895 - Epoch: 0 Iteration: 78  train.loss : 6.91797  train.total_ips : 648.77 img/s
DLL 2020-03-06 04:59:55.103202 - Epoch: 0 Iteration: 79  train.loss : 6.91797  train.total_ips : 649.99 img/s
DLL 2020-03-06 04:59:55.793234 - Epoch: 0 Iteration: 80  train.loss : 6.94141  train.total_ips : 649.31 img/s
DLL 2020-03-06 04:59:56.482718 - Epoch: 0 Iteration: 81  train.loss : 6.95312  train.total_ips : 649.82 img/s
DLL 2020-03-06 04:59:57.172175 - Epoch: 0 Iteration: 82  train.loss : 6.94141  train.total_ips : 649.86 img/s
DLL 2020-03-06 04:59:57.861955 - Epoch: 0 Iteration: 83  train.loss : 6.91406  train.total_ips : 649.53 img/s
DLL 2020-03-06 04:59:58.552149 - Epoch: 0 Iteration: 84  train.loss : 6.91797  train.total_ips : 649.16 img/s
DLL 2020-03-06 04:59:59.241751 - Epoch: 0 Iteration: 85  train.loss : 6.90234  train.total_ips : 649.72 img/s
DLL 2020-03-06 04:59:59.931265 - Epoch: 0 Iteration: 86  train.loss : 6.90234  train.total_ips : 649.80 img/s
DLL 2020-03-06 05:00:00.624124 - Epoch: 0 Iteration: 87  train.loss : 6.91016  train.total_ips : 646.66 img/s
DLL 2020-03-06 05:00:01.314037 - Epoch: 0 Iteration: 88  train.loss : 6.89844  train.total_ips : 649.46 img/s
DLL 2020-03-06 05:00:02.004582 - Epoch: 0 Iteration: 89  train.loss : 6.90625  train.total_ips : 648.82 img/s
DLL 2020-03-06 05:00:02.694564 - Epoch: 0 Iteration: 90  train.loss : 6.89844  train.total_ips : 649.36 img/s
DLL 2020-03-06 05:00:03.384186 - Epoch: 0 Iteration: 91  train.loss : 6.90625  train.total_ips : 649.70 img/s
DLL 2020-03-06 05:00:04.074699 - Epoch: 0 Iteration: 92  train.loss : 6.90625  train.total_ips : 648.86 img/s
DLL 2020-03-06 05:00:04.764687 - Epoch: 0 Iteration: 93  train.loss : 7.10547  train.total_ips : 649.35 img/s
DLL 2020-03-06 05:00:05.455496 - Epoch: 0 Iteration: 94  train.loss : 6.91016  train.total_ips : 648.58 img/s
DLL 2020-03-06 05:00:06.145681 - Epoch: 0 Iteration: 95  train.loss : 6.90234  train.total_ips : 649.16 img/s
DLL 2020-03-06 05:00:06.835310 - Epoch: 0 Iteration: 96  train.loss : 6.90234  train.total_ips : 649.69 img/s
DLL 2020-03-06 05:00:07.525614 - Epoch: 0 Iteration: 97  train.loss : 6.91797  train.total_ips : 649.05 img/s
DLL 2020-03-06 05:00:08.215663 - Epoch: 0 Iteration: 98  train.loss : 6.91016  train.total_ips : 649.33 img/s
DLL 2020-03-06 05:00:08.905531 - Epoch: 0 Iteration: 99  train.loss : 6.92188  train.total_ips : 649.46 img/s
DLL 2020-03-06 05:00:09.595738 - Epoch: 0  train.loss : 7.23707  train.total_ips : 643.13 img/s
DLL 2020-03-06 05:00:09.595849 - Epoch: 0  lr : 0.1  train.compute_ips : 644.62 img/s train.data_time : 0.00165 s train.compute_time : 0.78445 s
SAVING ./checkpoint.pth.tar
DLL 2020-03-06 05:00:10.177526 - Summary: train.loss : 7.23707  train.total_ips : 643.13 img/s
DLL 2020-03-06 05:00:10.177792 - Summary: lr : 0.1  train.compute_ips : 644.62 img/s train.data_time : 0.00165 s train.compute_time : 0.78445 s
Experiment ended
['/opt/conda/bin/python', '-u', './main.py', '/data/imagenet', '--arch', 'resnet50', '--amp', '--static-loss-scale', '256', '--epochs', '1', '--prof', '100', '--batch-size', '448', '--raport-file', 'benchmark.json', '--print-freq', '1', '--training-only']
DONE!
