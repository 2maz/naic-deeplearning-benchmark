:::NVLOGv0.1.0 ncf 1593678593.846251488 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1593678593.860166073 (ncf.py:171) mem_info: {"ram": "754G"}
:::NVLOGv0.1.0 ncf 1593678593.887520313 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1593678593.898526430 (ncf.py:171) mem_info: {"ram": "754G"}
:::NVLOGv0.1.0 ncf 1593678593.909559011 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1593678593.918684244 (ncf.py:171) mem_info: {"ram": "754G"}
:::NVLOGv0.1.0 ncf 1593678593.942094564 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1593678593.942168474 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1593678593.952653408 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1593678593.955744505 (ncf.py:171) mem_info: {"ram": "754G"}
:::NVLOGv0.1.0 ncf 1593678593.956030130 (ncf.py:171) mem_info: {"ram": "754G"}
:::NVLOGv0.1.0 ncf 1593678593.959903955 (ncf.py:171) mem_info: {"ram": "754G"}
:::NVLOGv0.1.0 ncf 1593678593.965833664 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1593678593.976678371 (ncf.py:171) mem_info: {"ram": "754G"}
:::NVLOGv0.1.0 ncf 1593678593.987550020 (ncf.py:171) cpu_info: {"num": 80, "name": "Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz"}
:::NVLOGv0.1.0 ncf 1593678593.998203039 (ncf.py:171) mem_info: {"ram": "754G"}
:::NVLOGv0.1.0 ncf 1593678596.851323128 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1593678597.214090586 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1593678597.218868971 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1593678597.565377474 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1593678597.567907333 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1593678597.569539070 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1593678597.569935560 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1593678597.570449829 (ncf.py:171) gpu_info: {"driver_version": "440.82", "num": 8, "name": ["GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti", "GeForce RTX 2080 Ti"], "mem": ["11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB", "11019 MiB"]}
:::NVLOGv0.1.0 ncf 1593678600.371644497 (ncf.py:174) args: {"data": "/data/ncf/cache/ml-20m", "epochs": 2, "batch_size": 5600000, "valid_batch_size": 1048576, "factors": 64, "layers": [256, 256, 128, 64], "negative_samples": 4, "learning_rate": 0.0045, "topk": 10, "seed": 1, "threshold": 1.0, "beta1": 0.25, "beta2": 0.5, "eps": 1e-08, "dropout": 0.5, "checkpoint_dir": "/data/checkpoints/", "load_checkpoint_path": null, "mode": "train", "grads_accumulated": 1, "opt_level": "O0", "local_rank": 0, "distributed": true, "world_size": 8}
Saving results to /data/checkpoints/
:::NVLOGv0.1.0 ncf 1593678600.373993397 (ncf.py:184) preproc_hp_sample_eval_replacement: true
:::NVLOGv0.1.0 ncf 1593678600.375105858 (ncf.py:185) input_hp_sample_train_replacement: true
:::NVLOGv0.1.0 ncf 1593678600.376123905 (ncf.py:186) input_step_eval_neg_gen
:::NVLOGv0.1.0 ncf 1593678604.489103317 (ncf.py:194) run_start
:::NVLOGv0.1.0 ncf 1593678604.905814409 (ncf.py:201) preproc_hp_num_eval: 100
:::NVLOGv0.1.0 ncf 1593678605.538149118 (ncf.py:207) input_size: 19861770
:::NVLOGv0.1.0 ncf 1593678605.586486340 (ncf.py:216) input_batch_size: 5600000
:::NVLOGv0.1.0 ncf 1593678605.587074280 (ncf.py:217) input_order
:::NVLOGv0.1.0 ncf 1593678605.588206291 (/workspace/examples/ncf/neumf.py:54) model_hp_mf_dim: 64
:::NVLOGv0.1.0 ncf 1593678605.917349339 (/workspace/examples/ncf/neumf.py:62) model_hp_mlp_layer_sizes: [256, 256, 128, 64]
DistributedDataParallel(
  (module): NeuMF(
    (mf_user_embed): Embedding(138493, 64)
    (mf_item_embed): Embedding(26744, 64)
    (mlp_user_embed): Embedding(138493, 128)
    (mlp_item_embed): Embedding(26744, 128)
    (mlp): ModuleList(
      (0): Linear(in_features=256, out_features=256, bias=True)
      (1): Linear(in_features=256, out_features=128, bias=True)
      (2): Linear(in_features=128, out_features=64, bias=True)
    )
    (final): Linear(in_features=128, out_features=1, bias=True)
  )
)
31832577 parameters
:::NVLOGv0.1.0 ncf 1593678606.383772850 (ncf.py:246) opt_learning_rate: 0.0045
:::NVLOGv0.1.0 ncf 1593678606.384166479 (ncf.py:247) opt_name: "Adam"
:::NVLOGv0.1.0 ncf 1593678606.384480476 (ncf.py:248) opt_hp_Adam_beta1: 0.25
:::NVLOGv0.1.0 ncf 1593678606.384786844 (ncf.py:249) opt_hp_Adam_beta2: 0.5
:::NVLOGv0.1.0 ncf 1593678606.385100842 (ncf.py:250) opt_hp_Adam_epsilon: 1e-08
:::NVLOGv0.1.0 ncf 1593678606.385400057 (ncf.py:251) model_hp_loss_fn: "binary_cross_entropy"
:::NVLOGv0.1.0 ncf 1593678606.385695457 (ncf.py:279) train_loop
:::NVLOGv0.1.0 ncf 1593678606.385996819 (ncf.py:282) train_epoch_start: 0
:::NVLOGv0.1.0 ncf 1593678606.386294603 (ncf.py:283) input_hp_num_neg: 4
:::NVLOGv0.1.0 ncf 1593678606.386583567 (ncf.py:284) input_step_train_neg_gen
:::NVLOGv0.1.0 ncf 1593678609.166059017 (ncf.py:318) train_throughput: 35754455.66739077
:::NVLOGv0.1.0 ncf 1593678609.167639256 (ncf.py:319) train_epoch_stop: 0
:::NVLOGv0.1.0 ncf 1593678609.168783903 (ncf.py:320) eval_start: 0
../aten/src/ATen/native/IndexingUtils.h:20: UserWarning: indexing with dtype torch.uint8 is now deprecated, please use a dtype torch.bool instead.
:::NVLOGv0.1.0 ncf 1593678609.293859005 (ncf.py:155) eval_size: {"epoch": 0, "value": 13987793}
:::NVLOGv0.1.0 ncf 1593678609.294405699 (ncf.py:156) eval_hp_num_users: 138493
:::NVLOGv0.1.0 ncf 1593678609.294879913 (ncf.py:157) eval_hp_num_neg: 100
/opt/conda/lib/python3.6/site-packages/torch/distributed/distributed_c10d.py:101: UserWarning: torch.distributed.reduce_op is deprecated, please use torch.distributed.ReduceOp instead
  warnings.warn("torch.distributed.reduce_op is deprecated, please use "
Epoch 0: HR@10 = 0.8341, NDCG@10 = 0.5483, train_time = 2.78, val_time = 0.13
:::NVLOGv0.1.0 ncf 1593678609.296983242 (ncf.py:333) eval_accuracy: {"epoch": 0, "value": 0.8340854772443372}
:::NVLOGv0.1.0 ncf 1593678609.297445059 (ncf.py:334) eval_target: 1.0
:::NVLOGv0.1.0 ncf 1593678609.297867298 (ncf.py:335) eval_stop: 0
:::NVLOGv0.1.0 ncf 1593678609.298285007 (ncf.py:340) eval_throughput: 105700298.04661554
New best hr! Saving the model to:  /data/checkpoints/model.pth
:::NVLOGv0.1.0 ncf 1593678609.530410528 (ncf.py:282) train_epoch_start: 1
:::NVLOGv0.1.0 ncf 1593678609.530911207 (ncf.py:283) input_hp_num_neg: 4
:::NVLOGv0.1.0 ncf 1593678609.531318426 (ncf.py:284) input_step_train_neg_gen
:::NVLOGv0.1.0 ncf 1593678611.778850794 (ncf.py:318) train_throughput: 44229083.46011555
:::NVLOGv0.1.0 ncf 1593678611.780503511 (ncf.py:319) train_epoch_stop: 1
:::NVLOGv0.1.0 ncf 1593678611.781663418 (ncf.py:320) eval_start: 1
../aten/src/ATen/native/IndexingUtils.h:20: UserWarning: indexing with dtype torch.uint8 is now deprecated, please use a dtype torch.bool instead.
:::NVLOGv0.1.0 ncf 1593678611.898133039 (ncf.py:155) eval_size: {"epoch": 1, "value": 13987793}
:::NVLOGv0.1.0 ncf 1593678611.898677826 (ncf.py:156) eval_hp_num_users: 138493
:::NVLOGv0.1.0 ncf 1593678611.899151087 (ncf.py:157) eval_hp_num_neg: 100
Epoch 1: HR@10 = 0.8400, NDCG@10 = 0.5579, train_time = 2.25, val_time = 0.12
:::NVLOGv0.1.0 ncf 1593678611.900433302 (ncf.py:333) eval_accuracy: {"epoch": 1, "value": 0.8400207952748514}
:::NVLOGv0.1.0 ncf 1593678611.900882483 (ncf.py:334) eval_target: 1.0
:::NVLOGv0.1.0 ncf 1593678611.901307821 (ncf.py:335) eval_stop: 1
:::NVLOGv0.1.0 ncf 1593678611.901723146 (ncf.py:340) eval_throughput: 113484628.2260986
New best hr! Saving the model to:  /data/checkpoints/model.pth
:::NVLOGv0.1.0 ncf 1593678612.096602440 (ncf.py:356) best_train_throughput: 44229083.46011555
:::NVLOGv0.1.0 ncf 1593678612.096994162 (ncf.py:357) best_eval_throughput: 113484628.2260986
:::NVLOGv0.1.0 ncf 1593678612.097332478 (ncf.py:358) best_accuracy: 0.8400207952748514
:::NVLOGv0.1.0 ncf 1593678612.097646236 (ncf.py:359) time_to_target: 7.608708381652832
:::NVLOGv0.1.0 ncf 1593678612.097954035 (ncf.py:360) time_to_best_model: 7.607501029968262
:::NVLOGv0.1.0 ncf 1593678612.098271132 (ncf.py:362) run_stop: {"success": false}
:::NVLOGv0.1.0 ncf 1593678612.098571301 (ncf.py:363) run_final
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
DONE!
