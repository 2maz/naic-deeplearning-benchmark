5: thread affinity: {65, 193, 69, 197, 73, 201, 77, 205, 81, 209, 85, 213, 89, 217, 93, 221, 253, 97, 225, 101, 229, 249, 105, 233, 109, 237, 113, 241, 117, 245, 121, 125}
0: thread affinity: {0, 128, 4, 132, 8, 136, 12, 140, 16, 144, 20, 148, 24, 152, 28, 156, 32, 160, 36, 164, 40, 168, 44, 172, 48, 176, 52, 180, 56, 184, 60, 188}
7: thread affinity: {67, 195, 71, 199, 75, 203, 79, 207, 83, 211, 87, 215, 91, 219, 247, 95, 223, 99, 227, 103, 231, 107, 235, 111, 239, 251, 115, 243, 119, 123, 127}
3: thread affinity: {3, 131, 7, 135, 11, 139, 15, 143, 19, 147, 23, 151, 27, 155, 31, 159, 35, 163, 39, 167, 43, 171, 47, 175, 51, 179, 55, 183, 59, 187, 63, 191}
1: thread affinity: {1, 129, 5, 133, 9, 137, 13, 141, 17, 145, 21, 149, 25, 153, 29, 157, 33, 161, 37, 165, 41, 169, 45, 173, 49, 177, 53, 181, 57, 185, 61, 189}
4: thread affinity: {64, 192, 68, 196, 72, 200, 76, 204, 80, 208, 84, 212, 88, 216, 92, 220, 96, 224, 248, 100, 228, 104, 232, 108, 236, 112, 240, 116, 244, 252, 120, 124}
2: thread affinity: {2, 130, 6, 134, 10, 138, 14, 142, 18, 146, 22, 150, 26, 154, 30, 158, 34, 162, 38, 166, 42, 170, 46, 174, 50, 178, 54, 182, 58, 186, 62, 190}
6: thread affinity: {66, 194, 70, 198, 74, 202, 78, 206, 82, 210, 254, 86, 214, 90, 218, 94, 222, 98, 226, 102, 230, 106, 234, 250, 110, 238, 114, 242, 118, 246, 122, 126}
0: Collecting environment information...
7: Collecting environment information...
4: Collecting environment information...
1: Collecting environment information...
2: Collecting environment information...
6: Collecting environment information...
5: Collecting environment information...
3: Collecting environment information...
0: PyTorch version: 1.9.0a0+df837d0
Is debug build: False
CUDA used to build PyTorch: 11.2
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.1 LTS (x86_64)
GCC version: (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
Clang version: Could not collect
CMake version: version 3.19.6

Python version: 3.8 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: 11.2.142
GPU models and configuration: 
GPU 0: A40
GPU 1: A40
GPU 2: A40
GPU 3: A40
GPU 4: A40
GPU 5: A40
GPU 6: A40
GPU 7: A40

Nvidia driver version: 460.84
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_train.so.8.1.1
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.19.2
[pip3] nvidia-dlprof-pytorch-nvtx==1.0.0
[pip3] pytorch-quantization==2.1.0
[pip3] pytorch-transformers==1.1.0
[pip3] torch==1.9.0a0+df837d0
[pip3] torchtext==0.9.0a0
[pip3] torchvision==0.9.0a0
[conda] magma-cuda110             2.5.2                         5    local
[conda] mkl                       2019.4                      243  
[conda] mkl-include               2019.4                      243  
[conda] nomkl                     3.0                           0  
[conda] numpy                     1.19.2           py38h6163131_0  
[conda] numpy-base                1.19.2           py38h75fe3a5_0  
[conda] nvidia-dlprof-pytorch-nvtx 1.0.0                    pypi_0    pypi
[conda] pytorch-quantization      2.1.0                    pypi_0    pypi
[conda] pytorch-transformers      1.1.0                    pypi_0    pypi
[conda] torch                     1.9.0a0+df837d0          pypi_0    pypi
[conda] torchtext                 0.9.0a0                  pypi_0    pypi
[conda] torchvision               0.9.0a0                  pypi_0    pypi
0: Saving results to: gnmt
0: Run arguments: Namespace(affinity='socket_unique_interleaved', batching='bucketing', beam_size=5, bpe_codes='/data/gnmt/wmt16_de_en/bpe.32000', cov_penalty_factor=0.1, cuda=True, cudnn=True, dataset_dir='/data/gnmt/wmt16_de_en', decay_factor=0.5, decay_interval=None, decay_steps=4, dllog_file='train_log.json', dropout=0.2, env=True, epochs=2, eval=True, grad_clip=5.0, hidden_size=1024, init_scale=8192, intra_epoch_eval=0, keep_checkpoints=0, lang={'src': 'en', 'tgt': 'de'}, len_norm_const=5.0, len_norm_factor=0.6, local_rank=0, log_all_ranks=True, lr=0.002, math='fp32', num_buckets=5, num_layers=4, optimizer='Adam', optimizer_extra='{}', prealloc_mode='always', print_freq=10, profile=False, rank=0, remain_steps=0.666, resume=None, save_all=False, save_dir='gnmt', save_freq=5000, seed=2, shard_size=80, share_embedding=True, smoothing=0.1, src_lang='en', start_epoch=0, target_bleu=None, target_perf=None, test_batch_size=32, test_loader_workers=0, test_max_length=150, test_min_length=0, test_src='/data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en', test_tgt='/data/gnmt/wmt16_de_en/newstest2014.de', tgt_lang='de', train_batch_size=648, train_global_batch_size=None, train_iter_size=1, train_loader_workers=2, train_max_length=50, train_max_size=None, train_min_length=0, train_src='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en', train_tgt='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de', upscale_interval=128, val_batch_size=32, val_loader_workers=0, val_max_length=125, val_min_length=0, val_src='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en', val_tgt='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de', vocab='/data/gnmt/wmt16_de_en/vocab.bpe.32000', warmup=1, warmup_steps=200)
0: Using master seed from command line: 2
2: PyTorch version: 1.9.0a0+df837d0
Is debug build: False
CUDA used to build PyTorch: 11.2
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.1 LTS (x86_64)
GCC version: (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
Clang version: Could not collect
CMake version: version 3.19.6

Python version: 3.8 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: 11.2.142
GPU models and configuration: 
GPU 0: A40
GPU 1: A40
GPU 2: A40
GPU 3: A40
GPU 4: A40
GPU 5: A40
GPU 6: A40
GPU 7: A40

Nvidia driver version: 460.84
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_train.so.8.1.1
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.19.2
[pip3] nvidia-dlprof-pytorch-nvtx==1.0.0
[pip3] pytorch-quantization==2.1.0
[pip3] pytorch-transformers==1.1.0
[pip3] torch==1.9.0a0+df837d0
[pip3] torchtext==0.9.0a0
[pip3] torchvision==0.9.0a0
[conda] magma-cuda110             2.5.2                         5    local
[conda] mkl                       2019.4                      243  
[conda] mkl-include               2019.4                      243  
[conda] nomkl                     3.0                           0  
[conda] numpy                     1.19.2           py38h6163131_0  
[conda] numpy-base                1.19.2           py38h75fe3a5_0  
[conda] nvidia-dlprof-pytorch-nvtx 1.0.0                    pypi_0    pypi
[conda] pytorch-quantization      2.1.0                    pypi_0    pypi
[conda] pytorch-transformers      1.1.0                    pypi_0    pypi
[conda] torch                     1.9.0a0+df837d0          pypi_0    pypi
[conda] torchtext                 0.9.0a0                  pypi_0    pypi
[conda] torchvision               0.9.0a0                  pypi_0    pypi
2: Saving results to: gnmt
2: Run arguments: Namespace(affinity='socket_unique_interleaved', batching='bucketing', beam_size=5, bpe_codes='/data/gnmt/wmt16_de_en/bpe.32000', cov_penalty_factor=0.1, cuda=True, cudnn=True, dataset_dir='/data/gnmt/wmt16_de_en', decay_factor=0.5, decay_interval=None, decay_steps=4, dllog_file='train_log.json', dropout=0.2, env=True, epochs=2, eval=True, grad_clip=5.0, hidden_size=1024, init_scale=8192, intra_epoch_eval=0, keep_checkpoints=0, lang={'src': 'en', 'tgt': 'de'}, len_norm_const=5.0, len_norm_factor=0.6, local_rank=2, log_all_ranks=True, lr=0.002, math='fp32', num_buckets=5, num_layers=4, optimizer='Adam', optimizer_extra='{}', prealloc_mode='always', print_freq=10, profile=False, rank=2, remain_steps=0.666, resume=None, save_all=False, save_dir='gnmt', save_freq=5000, seed=2, shard_size=80, share_embedding=True, smoothing=0.1, src_lang='en', start_epoch=0, target_bleu=None, target_perf=None, test_batch_size=32, test_loader_workers=0, test_max_length=150, test_min_length=0, test_src='/data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en', test_tgt='/data/gnmt/wmt16_de_en/newstest2014.de', tgt_lang='de', train_batch_size=648, train_global_batch_size=None, train_iter_size=1, train_loader_workers=2, train_max_length=50, train_max_size=None, train_min_length=0, train_src='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en', train_tgt='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de', upscale_interval=128, val_batch_size=32, val_loader_workers=0, val_max_length=125, val_min_length=0, val_src='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en', val_tgt='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de', vocab='/data/gnmt/wmt16_de_en/vocab.bpe.32000', warmup=1, warmup_steps=200)
2: Using master seed from command line: 2
3: PyTorch version: 1.9.0a0+df837d0
Is debug build: False
CUDA used to build PyTorch: 11.2
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.1 LTS (x86_64)
GCC version: (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
Clang version: Could not collect
CMake version: version 3.19.6

Python version: 3.8 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: 11.2.142
GPU models and configuration: 
GPU 0: A40
GPU 1: A40
GPU 2: A40
GPU 3: A40
GPU 4: A40
GPU 5: A40
GPU 6: A40
GPU 7: A40

Nvidia driver version: 460.84
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_train.so.8.1.1
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.19.2
[pip3] nvidia-dlprof-pytorch-nvtx==1.0.0
[pip3] pytorch-quantization==2.1.0
[pip3] pytorch-transformers==1.1.0
[pip3] torch==1.9.0a0+df837d0
[pip3] torchtext==0.9.0a0
[pip3] torchvision==0.9.0a0
[conda] magma-cuda110             2.5.2                         5    local
[conda] mkl                       2019.4                      243  
[conda] mkl-include               2019.4                      243  
[conda] nomkl                     3.0                           0  
[conda] numpy                     1.19.2           py38h6163131_0  
[conda] numpy-base                1.19.2           py38h75fe3a5_0  
[conda] nvidia-dlprof-pytorch-nvtx 1.0.0                    pypi_0    pypi
[conda] pytorch-quantization      2.1.0                    pypi_0    pypi
[conda] pytorch-transformers      1.1.0                    pypi_0    pypi
[conda] torch                     1.9.0a0+df837d0          pypi_0    pypi
[conda] torchtext                 0.9.0a0                  pypi_0    pypi
[conda] torchvision               0.9.0a0                  pypi_0    pypi
3: Saving results to: gnmt
3: Run arguments: Namespace(affinity='socket_unique_interleaved', batching='bucketing', beam_size=5, bpe_codes='/data/gnmt/wmt16_de_en/bpe.32000', cov_penalty_factor=0.1, cuda=True, cudnn=True, dataset_dir='/data/gnmt/wmt16_de_en', decay_factor=0.5, decay_interval=None, decay_steps=4, dllog_file='train_log.json', dropout=0.2, env=True, epochs=2, eval=True, grad_clip=5.0, hidden_size=1024, init_scale=8192, intra_epoch_eval=0, keep_checkpoints=0, lang={'src': 'en', 'tgt': 'de'}, len_norm_const=5.0, len_norm_factor=0.6, local_rank=3, log_all_ranks=True, lr=0.002, math='fp32', num_buckets=5, num_layers=4, optimizer='Adam', optimizer_extra='{}', prealloc_mode='always', print_freq=10, profile=False, rank=3, remain_steps=0.666, resume=None, save_all=False, save_dir='gnmt', save_freq=5000, seed=2, shard_size=80, share_embedding=True, smoothing=0.1, src_lang='en', start_epoch=0, target_bleu=None, target_perf=None, test_batch_size=32, test_loader_workers=0, test_max_length=150, test_min_length=0, test_src='/data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en', test_tgt='/data/gnmt/wmt16_de_en/newstest2014.de', tgt_lang='de', train_batch_size=648, train_global_batch_size=None, train_iter_size=1, train_loader_workers=2, train_max_length=50, train_max_size=None, train_min_length=0, train_src='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en', train_tgt='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de', upscale_interval=128, val_batch_size=32, val_loader_workers=0, val_max_length=125, val_min_length=0, val_src='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en', val_tgt='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de', vocab='/data/gnmt/wmt16_de_en/vocab.bpe.32000', warmup=1, warmup_steps=200)
3: Using master seed from command line: 2
5: PyTorch version: 1.9.0a0+df837d0
Is debug build: False
CUDA used to build PyTorch: 11.2
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.1 LTS (x86_64)
GCC version: (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
Clang version: Could not collect
CMake version: version 3.19.6

Python version: 3.8 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: 11.2.142
GPU models and configuration: 
GPU 0: A40
GPU 1: A40
GPU 2: A40
GPU 3: A40
GPU 4: A40
GPU 5: A40
GPU 6: A40
GPU 7: A40

Nvidia driver version: 460.84
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_train.so.8.1.1
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.19.2
[pip3] nvidia-dlprof-pytorch-nvtx==1.0.0
[pip3] pytorch-quantization==2.1.0
[pip3] pytorch-transformers==1.1.0
[pip3] torch==1.9.0a0+df837d0
[pip3] torchtext==0.9.0a0
[pip3] torchvision==0.9.0a0
[conda] magma-cuda110             2.5.2                         5    local
[conda] mkl                       2019.4                      243  
[conda] mkl-include               2019.4                      243  
[conda] nomkl                     3.0                           0  
[conda] numpy                     1.19.2           py38h6163131_0  
[conda] numpy-base                1.19.2           py38h75fe3a5_0  
[conda] nvidia-dlprof-pytorch-nvtx 1.0.0                    pypi_0    pypi
[conda] pytorch-quantization      2.1.0                    pypi_0    pypi
[conda] pytorch-transformers      1.1.0                    pypi_0    pypi
[conda] torch                     1.9.0a0+df837d0          pypi_0    pypi
[conda] torchtext                 0.9.0a0                  pypi_0    pypi
[conda] torchvision               0.9.0a0                  pypi_0    pypi
5: Saving results to: gnmt
5: Run arguments: Namespace(affinity='socket_unique_interleaved', batching='bucketing', beam_size=5, bpe_codes='/data/gnmt/wmt16_de_en/bpe.32000', cov_penalty_factor=0.1, cuda=True, cudnn=True, dataset_dir='/data/gnmt/wmt16_de_en', decay_factor=0.5, decay_interval=None, decay_steps=4, dllog_file='train_log.json', dropout=0.2, env=True, epochs=2, eval=True, grad_clip=5.0, hidden_size=1024, init_scale=8192, intra_epoch_eval=0, keep_checkpoints=0, lang={'src': 'en', 'tgt': 'de'}, len_norm_const=5.0, len_norm_factor=0.6, local_rank=5, log_all_ranks=True, lr=0.002, math='fp32', num_buckets=5, num_layers=4, optimizer='Adam', optimizer_extra='{}', prealloc_mode='always', print_freq=10, profile=False, rank=5, remain_steps=0.666, resume=None, save_all=False, save_dir='gnmt', save_freq=5000, seed=2, shard_size=80, share_embedding=True, smoothing=0.1, src_lang='en', start_epoch=0, target_bleu=None, target_perf=None, test_batch_size=32, test_loader_workers=0, test_max_length=150, test_min_length=0, test_src='/data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en', test_tgt='/data/gnmt/wmt16_de_en/newstest2014.de', tgt_lang='de', train_batch_size=648, train_global_batch_size=None, train_iter_size=1, train_loader_workers=2, train_max_length=50, train_max_size=None, train_min_length=0, train_src='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en', train_tgt='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de', upscale_interval=128, val_batch_size=32, val_loader_workers=0, val_max_length=125, val_min_length=0, val_src='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en', val_tgt='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de', vocab='/data/gnmt/wmt16_de_en/vocab.bpe.32000', warmup=1, warmup_steps=200)
5: Using master seed from command line: 2
4: PyTorch version: 1.9.0a0+df837d0
Is debug build: False
CUDA used to build PyTorch: 11.2
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.1 LTS (x86_64)
GCC version: (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
Clang version: Could not collect
CMake version: version 3.19.6

Python version: 3.8 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: 11.2.142
GPU models and configuration: 
GPU 0: A40
GPU 1: A40
GPU 2: A40
GPU 3: A40
GPU 4: A40
GPU 5: A40
GPU 6: A40
GPU 7: A40

Nvidia driver version: 460.84
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_train.so.8.1.1
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.19.2
[pip3] nvidia-dlprof-pytorch-nvtx==1.0.0
[pip3] pytorch-quantization==2.1.0
[pip3] pytorch-transformers==1.1.0
[pip3] torch==1.9.0a0+df837d0
[pip3] torchtext==0.9.0a0
[pip3] torchvision==0.9.0a0
[conda] magma-cuda110             2.5.2                         5    local
[conda] mkl                       2019.4                      243  
[conda] mkl-include               2019.4                      243  
[conda] nomkl                     3.0                           0  
[conda] numpy                     1.19.2           py38h6163131_0  
[conda] numpy-base                1.19.2           py38h75fe3a5_0  
[conda] nvidia-dlprof-pytorch-nvtx 1.0.0                    pypi_0    pypi
[conda] pytorch-quantization      2.1.0                    pypi_0    pypi
[conda] pytorch-transformers      1.1.0                    pypi_0    pypi
[conda] torch                     1.9.0a0+df837d0          pypi_0    pypi
[conda] torchtext                 0.9.0a0                  pypi_0    pypi
[conda] torchvision               0.9.0a0                  pypi_0    pypi
4: Saving results to: gnmt
4: Run arguments: Namespace(affinity='socket_unique_interleaved', batching='bucketing', beam_size=5, bpe_codes='/data/gnmt/wmt16_de_en/bpe.32000', cov_penalty_factor=0.1, cuda=True, cudnn=True, dataset_dir='/data/gnmt/wmt16_de_en', decay_factor=0.5, decay_interval=None, decay_steps=4, dllog_file='train_log.json', dropout=0.2, env=True, epochs=2, eval=True, grad_clip=5.0, hidden_size=1024, init_scale=8192, intra_epoch_eval=0, keep_checkpoints=0, lang={'src': 'en', 'tgt': 'de'}, len_norm_const=5.0, len_norm_factor=0.6, local_rank=4, log_all_ranks=True, lr=0.002, math='fp32', num_buckets=5, num_layers=4, optimizer='Adam', optimizer_extra='{}', prealloc_mode='always', print_freq=10, profile=False, rank=4, remain_steps=0.666, resume=None, save_all=False, save_dir='gnmt', save_freq=5000, seed=2, shard_size=80, share_embedding=True, smoothing=0.1, src_lang='en', start_epoch=0, target_bleu=None, target_perf=None, test_batch_size=32, test_loader_workers=0, test_max_length=150, test_min_length=0, test_src='/data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en', test_tgt='/data/gnmt/wmt16_de_en/newstest2014.de', tgt_lang='de', train_batch_size=648, train_global_batch_size=None, train_iter_size=1, train_loader_workers=2, train_max_length=50, train_max_size=None, train_min_length=0, train_src='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en', train_tgt='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de', upscale_interval=128, val_batch_size=32, val_loader_workers=0, val_max_length=125, val_min_length=0, val_src='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en', val_tgt='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de', vocab='/data/gnmt/wmt16_de_en/vocab.bpe.32000', warmup=1, warmup_steps=200)
4: Using master seed from command line: 2
6: PyTorch version: 1.9.0a0+df837d0
Is debug build: False
CUDA used to build PyTorch: 11.2
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.1 LTS (x86_64)
GCC version: (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
Clang version: Could not collect
CMake version: version 3.19.6

Python version: 3.8 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: 11.2.142
GPU models and configuration: 
GPU 0: A40
GPU 1: A40
GPU 2: A40
GPU 3: A40
GPU 4: A40
GPU 5: A40
GPU 6: A40
GPU 7: A40

Nvidia driver version: 460.84
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_train.so.8.1.1
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.19.2
[pip3] nvidia-dlprof-pytorch-nvtx==1.0.0
[pip3] pytorch-quantization==2.1.0
[pip3] pytorch-transformers==1.1.0
[pip3] torch==1.9.0a0+df837d0
[pip3] torchtext==0.9.0a0
[pip3] torchvision==0.9.0a0
[conda] magma-cuda110             2.5.2                         5    local
[conda] mkl                       2019.4                      243  
[conda] mkl-include               2019.4                      243  
[conda] nomkl                     3.0                           0  
[conda] numpy                     1.19.2           py38h6163131_0  
[conda] numpy-base                1.19.2           py38h75fe3a5_0  
[conda] nvidia-dlprof-pytorch-nvtx 1.0.0                    pypi_0    pypi
[conda] pytorch-quantization      2.1.0                    pypi_0    pypi
[conda] pytorch-transformers      1.1.0                    pypi_0    pypi
[conda] torch                     1.9.0a0+df837d0          pypi_0    pypi
[conda] torchtext                 0.9.0a0                  pypi_0    pypi
[conda] torchvision               0.9.0a0                  pypi_0    pypi
6: Saving results to: gnmt
6: Run arguments: Namespace(affinity='socket_unique_interleaved', batching='bucketing', beam_size=5, bpe_codes='/data/gnmt/wmt16_de_en/bpe.32000', cov_penalty_factor=0.1, cuda=True, cudnn=True, dataset_dir='/data/gnmt/wmt16_de_en', decay_factor=0.5, decay_interval=None, decay_steps=4, dllog_file='train_log.json', dropout=0.2, env=True, epochs=2, eval=True, grad_clip=5.0, hidden_size=1024, init_scale=8192, intra_epoch_eval=0, keep_checkpoints=0, lang={'src': 'en', 'tgt': 'de'}, len_norm_const=5.0, len_norm_factor=0.6, local_rank=6, log_all_ranks=True, lr=0.002, math='fp32', num_buckets=5, num_layers=4, optimizer='Adam', optimizer_extra='{}', prealloc_mode='always', print_freq=10, profile=False, rank=6, remain_steps=0.666, resume=None, save_all=False, save_dir='gnmt', save_freq=5000, seed=2, shard_size=80, share_embedding=True, smoothing=0.1, src_lang='en', start_epoch=0, target_bleu=None, target_perf=None, test_batch_size=32, test_loader_workers=0, test_max_length=150, test_min_length=0, test_src='/data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en', test_tgt='/data/gnmt/wmt16_de_en/newstest2014.de', tgt_lang='de', train_batch_size=648, train_global_batch_size=None, train_iter_size=1, train_loader_workers=2, train_max_length=50, train_max_size=None, train_min_length=0, train_src='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en', train_tgt='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de', upscale_interval=128, val_batch_size=32, val_loader_workers=0, val_max_length=125, val_min_length=0, val_src='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en', val_tgt='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de', vocab='/data/gnmt/wmt16_de_en/vocab.bpe.32000', warmup=1, warmup_steps=200)
6: Using master seed from command line: 2
7: PyTorch version: 1.9.0a0+df837d0
Is debug build: False
CUDA used to build PyTorch: 11.2
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.1 LTS (x86_64)
GCC version: (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
Clang version: Could not collect
CMake version: version 3.19.6

Python version: 3.8 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: 11.2.142
GPU models and configuration: 
GPU 0: A40
GPU 1: A40
GPU 2: A40
GPU 3: A40
GPU 4: A40
GPU 5: A40
GPU 6: A40
GPU 7: A40

Nvidia driver version: 460.84
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_train.so.8.1.1
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.19.2
[pip3] nvidia-dlprof-pytorch-nvtx==1.0.0
[pip3] pytorch-quantization==2.1.0
[pip3] pytorch-transformers==1.1.0
[pip3] torch==1.9.0a0+df837d0
[pip3] torchtext==0.9.0a0
[pip3] torchvision==0.9.0a0
[conda] magma-cuda110             2.5.2                         5    local
[conda] mkl                       2019.4                      243  
[conda] mkl-include               2019.4                      243  
[conda] nomkl                     3.0                           0  
[conda] numpy                     1.19.2           py38h6163131_0  
[conda] numpy-base                1.19.2           py38h75fe3a5_0  
[conda] nvidia-dlprof-pytorch-nvtx 1.0.0                    pypi_0    pypi
[conda] pytorch-quantization      2.1.0                    pypi_0    pypi
[conda] pytorch-transformers      1.1.0                    pypi_0    pypi
[conda] torch                     1.9.0a0+df837d0          pypi_0    pypi
[conda] torchtext                 0.9.0a0                  pypi_0    pypi
[conda] torchvision               0.9.0a0                  pypi_0    pypi
7: Saving results to: gnmt
7: Run arguments: Namespace(affinity='socket_unique_interleaved', batching='bucketing', beam_size=5, bpe_codes='/data/gnmt/wmt16_de_en/bpe.32000', cov_penalty_factor=0.1, cuda=True, cudnn=True, dataset_dir='/data/gnmt/wmt16_de_en', decay_factor=0.5, decay_interval=None, decay_steps=4, dllog_file='train_log.json', dropout=0.2, env=True, epochs=2, eval=True, grad_clip=5.0, hidden_size=1024, init_scale=8192, intra_epoch_eval=0, keep_checkpoints=0, lang={'src': 'en', 'tgt': 'de'}, len_norm_const=5.0, len_norm_factor=0.6, local_rank=7, log_all_ranks=True, lr=0.002, math='fp32', num_buckets=5, num_layers=4, optimizer='Adam', optimizer_extra='{}', prealloc_mode='always', print_freq=10, profile=False, rank=7, remain_steps=0.666, resume=None, save_all=False, save_dir='gnmt', save_freq=5000, seed=2, shard_size=80, share_embedding=True, smoothing=0.1, src_lang='en', start_epoch=0, target_bleu=None, target_perf=None, test_batch_size=32, test_loader_workers=0, test_max_length=150, test_min_length=0, test_src='/data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en', test_tgt='/data/gnmt/wmt16_de_en/newstest2014.de', tgt_lang='de', train_batch_size=648, train_global_batch_size=None, train_iter_size=1, train_loader_workers=2, train_max_length=50, train_max_size=None, train_min_length=0, train_src='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en', train_tgt='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de', upscale_interval=128, val_batch_size=32, val_loader_workers=0, val_max_length=125, val_min_length=0, val_src='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en', val_tgt='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de', vocab='/data/gnmt/wmt16_de_en/vocab.bpe.32000', warmup=1, warmup_steps=200)
7: Using master seed from command line: 2
1: PyTorch version: 1.9.0a0+df837d0
Is debug build: False
CUDA used to build PyTorch: 11.2
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.1 LTS (x86_64)
GCC version: (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
Clang version: Could not collect
CMake version: version 3.19.6

Python version: 3.8 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: 11.2.142
GPU models and configuration: 
GPU 0: A40
GPU 1: A40
GPU 2: A40
GPU 3: A40
GPU 4: A40
GPU 5: A40
GPU 6: A40
GPU 7: A40

Nvidia driver version: 460.84
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_adv_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_train.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_infer.so.8.1.1
/usr/lib/x86_64-linux-gnu/libcudnn_ops_train.so.8.1.1
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.19.2
[pip3] nvidia-dlprof-pytorch-nvtx==1.0.0
[pip3] pytorch-quantization==2.1.0
[pip3] pytorch-transformers==1.1.0
[pip3] torch==1.9.0a0+df837d0
[pip3] torchtext==0.9.0a0
[pip3] torchvision==0.9.0a0
[conda] magma-cuda110             2.5.2                         5    local
[conda] mkl                       2019.4                      243  
[conda] mkl-include               2019.4                      243  
[conda] nomkl                     3.0                           0  
[conda] numpy                     1.19.2           py38h6163131_0  
[conda] numpy-base                1.19.2           py38h75fe3a5_0  
[conda] nvidia-dlprof-pytorch-nvtx 1.0.0                    pypi_0    pypi
[conda] pytorch-quantization      2.1.0                    pypi_0    pypi
[conda] pytorch-transformers      1.1.0                    pypi_0    pypi
[conda] torch                     1.9.0a0+df837d0          pypi_0    pypi
[conda] torchtext                 0.9.0a0                  pypi_0    pypi
[conda] torchvision               0.9.0a0                  pypi_0    pypi
1: Saving results to: gnmt
1: Run arguments: Namespace(affinity='socket_unique_interleaved', batching='bucketing', beam_size=5, bpe_codes='/data/gnmt/wmt16_de_en/bpe.32000', cov_penalty_factor=0.1, cuda=True, cudnn=True, dataset_dir='/data/gnmt/wmt16_de_en', decay_factor=0.5, decay_interval=None, decay_steps=4, dllog_file='train_log.json', dropout=0.2, env=True, epochs=2, eval=True, grad_clip=5.0, hidden_size=1024, init_scale=8192, intra_epoch_eval=0, keep_checkpoints=0, lang={'src': 'en', 'tgt': 'de'}, len_norm_const=5.0, len_norm_factor=0.6, local_rank=1, log_all_ranks=True, lr=0.002, math='fp32', num_buckets=5, num_layers=4, optimizer='Adam', optimizer_extra='{}', prealloc_mode='always', print_freq=10, profile=False, rank=1, remain_steps=0.666, resume=None, save_all=False, save_dir='gnmt', save_freq=5000, seed=2, shard_size=80, share_embedding=True, smoothing=0.1, src_lang='en', start_epoch=0, target_bleu=None, target_perf=None, test_batch_size=32, test_loader_workers=0, test_max_length=150, test_min_length=0, test_src='/data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en', test_tgt='/data/gnmt/wmt16_de_en/newstest2014.de', tgt_lang='de', train_batch_size=648, train_global_batch_size=None, train_iter_size=1, train_loader_workers=2, train_max_length=50, train_max_size=None, train_min_length=0, train_src='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en', train_tgt='/data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de', upscale_interval=128, val_batch_size=32, val_loader_workers=0, val_max_length=125, val_min_length=0, val_src='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en', val_tgt='/data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de', vocab='/data/gnmt/wmt16_de_en/vocab.bpe.32000', warmup=1, warmup_steps=200)
1: Using master seed from command line: 2
0: Worker 0 is using worker seed: 242886303
1: Worker 1 is using worker seed: 364522461
4: Worker 4 is using worker seed: 2602510382
7: Worker 7 is using worker seed: 117874757
5: Worker 5 is using worker seed: 2606193617
6: Worker 6 is using worker seed: 4077622522
2: Worker 2 is using worker seed: 3588440356
3: Worker 3 is using worker seed: 1323436024
6: Building vocabulary from /data/gnmt/wmt16_de_en/vocab.bpe.32000
5: Building vocabulary from /data/gnmt/wmt16_de_en/vocab.bpe.32000
7: Building vocabulary from /data/gnmt/wmt16_de_en/vocab.bpe.32000
4: Building vocabulary from /data/gnmt/wmt16_de_en/vocab.bpe.32000
6: Size of vocabulary: 31794
5: Size of vocabulary: 31794
7: Size of vocabulary: 31794
0: Building vocabulary from /data/gnmt/wmt16_de_en/vocab.bpe.32000
4: Size of vocabulary: 31794
2: Building vocabulary from /data/gnmt/wmt16_de_en/vocab.bpe.32000
0: Size of vocabulary: 31794
3: Building vocabulary from /data/gnmt/wmt16_de_en/vocab.bpe.32000
2: Size of vocabulary: 31794
1: Building vocabulary from /data/gnmt/wmt16_de_en/vocab.bpe.32000
6: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en
5: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en
7: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en
4: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en
3: Size of vocabulary: 31794
1: Size of vocabulary: 31794
0: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en
2: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en
3: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en
1: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.en
6: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de
4: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de
5: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de
7: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de
0: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de
2: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de
3: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de
1: Processing data from /data/gnmt/wmt16_de_en/train.tok.clean.bpe.32000.de
6: Filtering data, min len: 0, max len: 50
4: Filtering data, min len: 0, max len: 50
5: Filtering data, min len: 0, max len: 50
7: Filtering data, min len: 0, max len: 50
0: Filtering data, min len: 0, max len: 50
2: Filtering data, min len: 0, max len: 50
1: Filtering data, min len: 0, max len: 50
3: Filtering data, min len: 0, max len: 50
6: Pairs before: 160078, after: 148120
5: Pairs before: 160078, after: 148120
4: Pairs before: 160078, after: 148120
7: Pairs before: 160078, after: 148120
0: Pairs before: 160078, after: 148120
2: Pairs before: 160078, after: 148120
1: Pairs before: 160078, after: 148120
3: Pairs before: 160078, after: 148120
6: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en
5: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en
4: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en
7: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en
0: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en
2: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en
1: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en
3: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en
6: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de
4: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de
5: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de
7: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de
0: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de
2: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de
1: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de
3: Processing data from /data/gnmt/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de
6: Filtering data, min len: 0, max len: 125
4: Filtering data, min len: 0, max len: 125
5: Filtering data, min len: 0, max len: 125
7: Filtering data, min len: 0, max len: 125
6: Pairs before: 5100, after: 5100
4: Pairs before: 5100, after: 5100
5: Pairs before: 5100, after: 5100
7: Pairs before: 5100, after: 5100
0: Filtering data, min len: 0, max len: 125
2: Filtering data, min len: 0, max len: 125
0: Pairs before: 5100, after: 5100
1: Filtering data, min len: 0, max len: 125
2: Pairs before: 5100, after: 5100
3: Filtering data, min len: 0, max len: 125
1: Pairs before: 5100, after: 5100
3: Pairs before: 5100, after: 5100
6: Processing data from /data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en
4: Processing data from /data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en
7: Processing data from /data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en
5: Processing data from /data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en
0: Processing data from /data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en
6: Filtering data, min len: 0, max len: 150
6: Pairs before: 3003, after: 3003
4: Filtering data, min len: 0, max len: 150
4: Pairs before: 3003, after: 3003
7: Filtering data, min len: 0, max len: 150
2: Processing data from /data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en
7: Pairs before: 3003, after: 3003
5: Filtering data, min len: 0, max len: 150
5: Pairs before: 3003, after: 3003
3: Processing data from /data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en
1: Processing data from /data/gnmt/wmt16_de_en/newstest2014.tok.bpe.32000.en
0: Filtering data, min len: 0, max len: 150
0: Pairs before: 3003, after: 3003
2: Filtering data, min len: 0, max len: 150
2: Pairs before: 3003, after: 3003
3: Filtering data, min len: 0, max len: 150
1: Filtering data, min len: 0, max len: 150
3: Pairs before: 3003, after: 3003
1: Pairs before: 3003, after: 3003
0: GNMT(
  (encoder): ResidualRecurrentEncoder(
    (rnn_layers): ModuleList(
      (0): LSTM(1024, 1024, bidirectional=True)
      (1): LSTM(2048, 1024)
      (2): LSTM(1024, 1024)
      (3): LSTM(1024, 1024)
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (embedder): Embedding(31794, 1024, padding_idx=0)
  )
  (decoder): ResidualRecurrentDecoder(
    (att_rnn): RecurrentAttention(
      (rnn): LSTM(1024, 1024)
      (attn): BahdanauAttention(
        (linear_q): Linear(in_features=1024, out_features=1024, bias=False)
        (linear_k): Linear(in_features=1024, out_features=1024, bias=False)
      )
      (dropout): Dropout(p=0.2, inplace=False)
    )
    (rnn_layers): ModuleList(
      (0): LSTM(2048, 1024)
      (1): LSTM(2048, 1024)
      (2): LSTM(2048, 1024)
    )
    (embedder): Embedding(31794, 1024, padding_idx=0)
    (classifier): Classifier(
      (classifier): Linear(in_features=1024, out_features=31794, bias=True)
    )
    (dropout): Dropout(p=0.2, inplace=False)
  )
)
0: Building LabelSmoothingLoss (smoothing: 0.1)
0: Training optimizer config: {'optimizer': 'Adam', 'lr': 0.002}
0: Training LR schedule config: {'warmup_steps': 200, 'remain_steps': 0.666, 'decay_interval': None, 'decay_steps': 4, 'decay_factor': 0.5}
0: Number of parameters: 159593523
/opt/conda/lib/python3.8/site-packages/torch/tensor.py:559: UserWarning: floor_divide is deprecated, and will be removed in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values.
To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor'). (Triggered internally at  ../aten/src/ATen/native/BinaryOps.cpp:335.)
  return torch.floor_divide(self, other)
0: Saving state of the tokenizer
0: Initializing fp32 optimizer
0: Using optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.002
    weight_decay: 0
)
0: Scheduler warmup steps: 200
0: Scheduler remain steps: 34
0: Scheduler decay interval: 4
0: Scheduler decay factor: 0.5
0: Scheduler max decay steps: 4
0: warmup_steps should not be larger than remain_steps, setting warmup_steps=remain_steps
0: Starting epoch 0
0: Executing preallocation
2: GNMT(
  (encoder): ResidualRecurrentEncoder(
    (rnn_layers): ModuleList(
      (0): LSTM(1024, 1024, bidirectional=True)
      (1): LSTM(2048, 1024)
      (2): LSTM(1024, 1024)
      (3): LSTM(1024, 1024)
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (embedder): Embedding(31794, 1024, padding_idx=0)
  )
  (decoder): ResidualRecurrentDecoder(
    (att_rnn): RecurrentAttention(
      (rnn): LSTM(1024, 1024)
      (attn): BahdanauAttention(
        (linear_q): Linear(in_features=1024, out_features=1024, bias=False)
        (linear_k): Linear(in_features=1024, out_features=1024, bias=False)
      )
      (dropout): Dropout(p=0.2, inplace=False)
    )
    (rnn_layers): ModuleList(
      (0): LSTM(2048, 1024)
      (1): LSTM(2048, 1024)
      (2): LSTM(2048, 1024)
    )
    (embedder): Embedding(31794, 1024, padding_idx=0)
    (classifier): Classifier(
      (classifier): Linear(in_features=1024, out_features=31794, bias=True)
    )
    (dropout): Dropout(p=0.2, inplace=False)
  )
)
2: Building LabelSmoothingLoss (smoothing: 0.1)
2: Training optimizer config: {'optimizer': 'Adam', 'lr': 0.002}
2: Training LR schedule config: {'warmup_steps': 200, 'remain_steps': 0.666, 'decay_interval': None, 'decay_steps': 4, 'decay_factor': 0.5}
2: Number of parameters: 159593523
/opt/conda/lib/python3.8/site-packages/torch/tensor.py:559: UserWarning: floor_divide is deprecated, and will be removed in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values.
To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor'). (Triggered internally at  ../aten/src/ATen/native/BinaryOps.cpp:335.)
  return torch.floor_divide(self, other)
2: Saving state of the tokenizer
2: Initializing fp32 optimizer
2: Using optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.002
    weight_decay: 0
)
2: Scheduler warmup steps: 200
2: Scheduler remain steps: 34
2: Scheduler decay interval: 4
2: Scheduler decay factor: 0.5
2: Scheduler max decay steps: 4
2: warmup_steps should not be larger than remain_steps, setting warmup_steps=remain_steps
1: GNMT(
  (encoder): ResidualRecurrentEncoder(
    (rnn_layers): ModuleList(
      (0): LSTM(1024, 1024, bidirectional=True)
      (1): LSTM(2048, 1024)
      (2): LSTM(1024, 1024)
      (3): LSTM(1024, 1024)
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (embedder): Embedding(31794, 1024, padding_idx=0)
  )
  (decoder): ResidualRecurrentDecoder(
    (att_rnn): RecurrentAttention(
      (rnn): LSTM(1024, 1024)
      (attn): BahdanauAttention(
        (linear_q): Linear(in_features=1024, out_features=1024, bias=False)
        (linear_k): Linear(in_features=1024, out_features=1024, bias=False)
      )
      (dropout): Dropout(p=0.2, inplace=False)
    )
    (rnn_layers): ModuleList(
      (0): LSTM(2048, 1024)
      (1): LSTM(2048, 1024)
      (2): LSTM(2048, 1024)
    )
    (embedder): Embedding(31794, 1024, padding_idx=0)
    (classifier): Classifier(
      (classifier): Linear(in_features=1024, out_features=31794, bias=True)
    )
    (dropout): Dropout(p=0.2, inplace=False)
  )
)
1: Building LabelSmoothingLoss (smoothing: 0.1)
1: Training optimizer config: {'optimizer': 'Adam', 'lr': 0.002}
1: Training LR schedule config: {'warmup_steps': 200, 'remain_steps': 0.666, 'decay_interval': None, 'decay_steps': 4, 'decay_factor': 0.5}
1: Number of parameters: 159593523
3: GNMT(
  (encoder): ResidualRecurrentEncoder(
    (rnn_layers): ModuleList(
      (0): LSTM(1024, 1024, bidirectional=True)
      (1): LSTM(2048, 1024)
      (2): LSTM(1024, 1024)
      (3): LSTM(1024, 1024)
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (embedder): Embedding(31794, 1024, padding_idx=0)
  )
  (decoder): ResidualRecurrentDecoder(
    (att_rnn): RecurrentAttention(
      (rnn): LSTM(1024, 1024)
      (attn): BahdanauAttention(
        (linear_q): Linear(in_features=1024, out_features=1024, bias=False)
        (linear_k): Linear(in_features=1024, out_features=1024, bias=False)
      )
      (dropout): Dropout(p=0.2, inplace=False)
    )
    (rnn_layers): ModuleList(
      (0): LSTM(2048, 1024)
      (1): LSTM(2048, 1024)
      (2): LSTM(2048, 1024)
    )
    (embedder): Embedding(31794, 1024, padding_idx=0)
    (classifier): Classifier(
      (classifier): Linear(in_features=1024, out_features=31794, bias=True)
    )
    (dropout): Dropout(p=0.2, inplace=False)
  )
)
3: Building LabelSmoothingLoss (smoothing: 0.1)
7: GNMT(
  (encoder): ResidualRecurrentEncoder(
    (rnn_layers): ModuleList(
      (0): LSTM(1024, 1024, bidirectional=True)
      (1): LSTM(2048, 1024)
      (2): LSTM(1024, 1024)
      (3): LSTM(1024, 1024)
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (embedder): Embedding(31794, 1024, padding_idx=0)
  )
  (decoder): ResidualRecurrentDecoder(
    (att_rnn): RecurrentAttention(
      (rnn): LSTM(1024, 1024)
      (attn): BahdanauAttention(
        (linear_q): Linear(in_features=1024, out_features=1024, bias=False)
        (linear_k): Linear(in_features=1024, out_features=1024, bias=False)
      )
      (dropout): Dropout(p=0.2, inplace=False)
    )
    (rnn_layers): ModuleList(
      (0): LSTM(2048, 1024)
      (1): LSTM(2048, 1024)
      (2): LSTM(2048, 1024)
    )
    (embedder): Embedding(31794, 1024, padding_idx=0)
    (classifier): Classifier(
      (classifier): Linear(in_features=1024, out_features=31794, bias=True)
    )
    (dropout): Dropout(p=0.2, inplace=False)
  )
)
7: Building LabelSmoothingLoss (smoothing: 0.1)
3: Training optimizer config: {'optimizer': 'Adam', 'lr': 0.002}
3: Training LR schedule config: {'warmup_steps': 200, 'remain_steps': 0.666, 'decay_interval': None, 'decay_steps': 4, 'decay_factor': 0.5}
7: Training optimizer config: {'optimizer': 'Adam', 'lr': 0.002}
7: Training LR schedule config: {'warmup_steps': 200, 'remain_steps': 0.666, 'decay_interval': None, 'decay_steps': 4, 'decay_factor': 0.5}
/opt/conda/lib/python3.8/site-packages/torch/tensor.py:559: UserWarning: floor_divide is deprecated, and will be removed in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values.
To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor'). (Triggered internally at  ../aten/src/ATen/native/BinaryOps.cpp:335.)
  return torch.floor_divide(self, other)
3: Number of parameters: 159593523
7: Number of parameters: 159593523
/opt/conda/lib/python3.8/site-packages/torch/tensor.py:559: UserWarning: floor_divide is deprecated, and will be removed in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values.
To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor'). (Triggered internally at  ../aten/src/ATen/native/BinaryOps.cpp:335.)
  return torch.floor_divide(self, other)
/opt/conda/lib/python3.8/site-packages/torch/tensor.py:559: UserWarning: floor_divide is deprecated, and will be removed in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values.
To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor'). (Triggered internally at  ../aten/src/ATen/native/BinaryOps.cpp:335.)
  return torch.floor_divide(self, other)
2: Starting epoch 0
2: Executing preallocation
1: Saving state of the tokenizer
1: Initializing fp32 optimizer
1: Using optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.002
    weight_decay: 0
)
1: Scheduler warmup steps: 200
1: Scheduler remain steps: 34
1: Scheduler decay interval: 4
1: Scheduler decay factor: 0.5
1: Scheduler max decay steps: 4
1: warmup_steps should not be larger than remain_steps, setting warmup_steps=remain_steps
7: Saving state of the tokenizer
7: Initializing fp32 optimizer
7: Using optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.002
    weight_decay: 0
)
7: Scheduler warmup steps: 200
7: Scheduler remain steps: 34
7: Scheduler decay interval: 4
7: Scheduler decay factor: 0.5
7: Scheduler max decay steps: 4
7: warmup_steps should not be larger than remain_steps, setting warmup_steps=remain_steps
3: Saving state of the tokenizer
3: Initializing fp32 optimizer
3: Using optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.002
    weight_decay: 0
)
3: Scheduler warmup steps: 200
3: Scheduler remain steps: 34
3: Scheduler decay interval: 4
3: Scheduler decay factor: 0.5
3: Scheduler max decay steps: 4
5: GNMT(
  (encoder): ResidualRecurrentEncoder(
    (rnn_layers): ModuleList(
      (0): LSTM(1024, 1024, bidirectional=True)
      (1): LSTM(2048, 1024)
      (2): LSTM(1024, 1024)
      (3): LSTM(1024, 1024)
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (embedder): Embedding(31794, 1024, padding_idx=0)
  )
  (decoder): ResidualRecurrentDecoder(
    (att_rnn): RecurrentAttention(
      (rnn): LSTM(1024, 1024)
      (attn): BahdanauAttention(
        (linear_q): Linear(in_features=1024, out_features=1024, bias=False)
        (linear_k): Linear(in_features=1024, out_features=1024, bias=False)
      )
      (dropout): Dropout(p=0.2, inplace=False)
    )
    (rnn_layers): ModuleList(
      (0): LSTM(2048, 1024)
      (1): LSTM(2048, 1024)
      (2): LSTM(2048, 1024)
    )
    (embedder): Embedding(31794, 1024, padding_idx=0)
    (classifier): Classifier(
      (classifier): Linear(in_features=1024, out_features=31794, bias=True)
    )
    (dropout): Dropout(p=0.2, inplace=False)
  )
)
5: Building LabelSmoothingLoss (smoothing: 0.1)
3: warmup_steps should not be larger than remain_steps, setting warmup_steps=remain_steps
5: Training optimizer config: {'optimizer': 'Adam', 'lr': 0.002}
5: Training LR schedule config: {'warmup_steps': 200, 'remain_steps': 0.666, 'decay_interval': None, 'decay_steps': 4, 'decay_factor': 0.5}
1: Starting epoch 0
5: Number of parameters: 159593523
1: Executing preallocation
4: GNMT(
  (encoder): ResidualRecurrentEncoder(
    (rnn_layers): ModuleList(
      (0): LSTM(1024, 1024, bidirectional=True)
      (1): LSTM(2048, 1024)
      (2): LSTM(1024, 1024)
      (3): LSTM(1024, 1024)
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (embedder): Embedding(31794, 1024, padding_idx=0)
  )
  (decoder): ResidualRecurrentDecoder(
    (att_rnn): RecurrentAttention(
      (rnn): LSTM(1024, 1024)
      (attn): BahdanauAttention(
        (linear_q): Linear(in_features=1024, out_features=1024, bias=False)
        (linear_k): Linear(in_features=1024, out_features=1024, bias=False)
      )
      (dropout): Dropout(p=0.2, inplace=False)
    )
    (rnn_layers): ModuleList(
      (0): LSTM(2048, 1024)
      (1): LSTM(2048, 1024)
      (2): LSTM(2048, 1024)
    )
    (embedder): Embedding(31794, 1024, padding_idx=0)
    (classifier): Classifier(
      (classifier): Linear(in_features=1024, out_features=31794, bias=True)
    )
    (dropout): Dropout(p=0.2, inplace=False)
  )
)
4: Building LabelSmoothingLoss (smoothing: 0.1)
7: Starting epoch 0
4: Training optimizer config: {'optimizer': 'Adam', 'lr': 0.002}
7: Executing preallocation
/opt/conda/lib/python3.8/site-packages/torch/tensor.py:559: UserWarning: floor_divide is deprecated, and will be removed in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values.
To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor'). (Triggered internally at  ../aten/src/ATen/native/BinaryOps.cpp:335.)
  return torch.floor_divide(self, other)
4: Training LR schedule config: {'warmup_steps': 200, 'remain_steps': 0.666, 'decay_interval': None, 'decay_steps': 4, 'decay_factor': 0.5}
4: Number of parameters: 159593523
/opt/conda/lib/python3.8/site-packages/torch/tensor.py:559: UserWarning: floor_divide is deprecated, and will be removed in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values.
To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor'). (Triggered internally at  ../aten/src/ATen/native/BinaryOps.cpp:335.)
  return torch.floor_divide(self, other)
3: Starting epoch 0
3: Executing preallocation
5: Saving state of the tokenizer
5: Initializing fp32 optimizer
5: Using optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.002
    weight_decay: 0
)
5: Scheduler warmup steps: 200
5: Scheduler remain steps: 34
5: Scheduler decay interval: 4
5: Scheduler decay factor: 0.5
5: Scheduler max decay steps: 4
5: warmup_steps should not be larger than remain_steps, setting warmup_steps=remain_steps
4: Saving state of the tokenizer
4: Initializing fp32 optimizer
6: GNMT(
  (encoder): ResidualRecurrentEncoder(
    (rnn_layers): ModuleList(
      (0): LSTM(1024, 1024, bidirectional=True)
      (1): LSTM(2048, 1024)
      (2): LSTM(1024, 1024)
      (3): LSTM(1024, 1024)
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (embedder): Embedding(31794, 1024, padding_idx=0)
  )
  (decoder): ResidualRecurrentDecoder(
    (att_rnn): RecurrentAttention(
      (rnn): LSTM(1024, 1024)
      (attn): BahdanauAttention(
        (linear_q): Linear(in_features=1024, out_features=1024, bias=False)
        (linear_k): Linear(in_features=1024, out_features=1024, bias=False)
      )
      (dropout): Dropout(p=0.2, inplace=False)
    )
    (rnn_layers): ModuleList(
      (0): LSTM(2048, 1024)
      (1): LSTM(2048, 1024)
      (2): LSTM(2048, 1024)
    )
    (embedder): Embedding(31794, 1024, padding_idx=0)
    (classifier): Classifier(
      (classifier): Linear(in_features=1024, out_features=31794, bias=True)
    )
    (dropout): Dropout(p=0.2, inplace=False)
  )
)
6: Building LabelSmoothingLoss (smoothing: 0.1)
6: Training optimizer config: {'optimizer': 'Adam', 'lr': 0.002}
6: Training LR schedule config: {'warmup_steps': 200, 'remain_steps': 0.666, 'decay_interval': None, 'decay_steps': 4, 'decay_factor': 0.5}
4: Using optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.002
    weight_decay: 0
)
4: Scheduler warmup steps: 200
4: Scheduler remain steps: 34
6: Number of parameters: 159593523
4: Scheduler decay interval: 4
4: Scheduler decay factor: 0.5
4: Scheduler max decay steps: 4
4: warmup_steps should not be larger than remain_steps, setting warmup_steps=remain_steps
/opt/conda/lib/python3.8/site-packages/torch/tensor.py:559: UserWarning: floor_divide is deprecated, and will be removed in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values.
To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor'). (Triggered internally at  ../aten/src/ATen/native/BinaryOps.cpp:335.)
  return torch.floor_divide(self, other)
5: Starting epoch 0
4: Starting epoch 0
5: Executing preallocation
4: Executing preallocation
6: Saving state of the tokenizer
6: Initializing fp32 optimizer
6: Using optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.002
    weight_decay: 0
)
6: Scheduler warmup steps: 200
6: Scheduler remain steps: 34
6: Scheduler decay interval: 4
6: Scheduler decay factor: 0.5
6: Scheduler max decay steps: 4
6: warmup_steps should not be larger than remain_steps, setting warmup_steps=remain_steps
6: Starting epoch 0
6: Executing preallocation
0: Sampler for epoch 0 uses seed 1632151663
1: Sampler for epoch 0 uses seed 1632151663
2: Sampler for epoch 0 uses seed 1632151663
4: Sampler for epoch 0 uses seed 1632151663
7: Sampler for epoch 0 uses seed 1632151663
3: Sampler for epoch 0 uses seed 1632151663
6: Sampler for epoch 0 uses seed 1632151663
5: Sampler for epoch 0 uses seed 1632151663
/opt/conda/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:129: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/opt/conda/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:129: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/opt/conda/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:129: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/opt/conda/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:129: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/opt/conda/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:129: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/opt/conda/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:129: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/opt/conda/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:129: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/opt/conda/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:129: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
1: TRAIN [0][0/26]	Time 1.963 (0.000)	Data 3.87e-01 (0.00e+00)	Tok/s 8956 (0)	Loss/tok 10.6045 (10.6045)	LR 2.290e-05
0: TRAIN [0][0/26]	Time 2.470 (0.000)	Data 3.54e-01 (0.00e+00)	Tok/s 7044 (0)	Loss/tok 10.6009 (10.6009)	LR 2.290e-05
2: TRAIN [0][0/26]	Time 1.956 (0.000)	Data 5.08e-01 (0.00e+00)	Tok/s 8939 (0)	Loss/tok 10.5984 (10.5984)	LR 2.290e-05
3: TRAIN [0][0/26]	Time 1.957 (0.000)	Data 6.09e-01 (0.00e+00)	Tok/s 8935 (0)	Loss/tok 10.6046 (10.6046)	LR 2.290e-05
6: TRAIN [0][0/26]	Time 1.957 (0.000)	Data 6.58e-01 (0.00e+00)	Tok/s 8942 (0)	Loss/tok 10.5915 (10.5915)	LR 2.290e-05
5: TRAIN [0][0/26]	Time 1.958 (0.000)	Data 6.87e-01 (0.00e+00)	Tok/s 8793 (0)	Loss/tok 10.5974 (10.5974)	LR 2.290e-05
4: TRAIN [0][0/26]	Time 1.958 (0.000)	Data 5.03e-01 (0.00e+00)	Tok/s 8962 (0)	Loss/tok 10.6061 (10.6061)	LR 2.290e-05
7: TRAIN [0][0/26]	Time 1.957 (0.000)	Data 5.46e-01 (0.00e+00)	Tok/s 9084 (0)	Loss/tok 10.6040 (10.6040)	LR 2.290e-05
0: TRAIN [0][10/26]	Time 0.828 (0.907)	Data 2.30e-04 (2.32e-04)	Tok/s 35247 (33629)	Loss/tok 9.2926 (9.9113)	LR 8.873e-05
7: TRAIN [0][10/26]	Time 0.828 (0.907)	Data 2.48e-04 (2.77e-04)	Tok/s 35171 (33728)	Loss/tok 9.2764 (9.9123)	LR 8.873e-05
5: TRAIN [0][10/26]	Time 0.828 (0.907)	Data 2.47e-04 (2.74e-04)	Tok/s 35334 (33780)	Loss/tok 9.2553 (9.9103)	LR 8.873e-05
6: TRAIN [0][10/26]	Time 0.828 (0.907)	Data 2.41e-04 (2.54e-04)	Tok/s 35151 (33671)	Loss/tok 9.2750 (9.9130)	LR 8.873e-05
4: TRAIN [0][10/26]	Time 0.828 (0.907)	Data 2.32e-04 (2.40e-04)	Tok/s 35401 (33653)	Loss/tok 9.2621 (9.9091)	LR 8.873e-05
3: TRAIN [0][10/26]	Time 0.828 (0.907)	Data 2.16e-04 (2.23e-04)	Tok/s 35456 (33576)	Loss/tok 9.2831 (9.9114)	LR 8.873e-05
1: TRAIN [0][10/26]	Time 0.828 (0.907)	Data 2.06e-04 (2.26e-04)	Tok/s 35424 (33622)	Loss/tok 9.2742 (9.9110)	LR 8.873e-05
2: TRAIN [0][10/26]	Time 0.829 (0.907)	Data 2.08e-04 (2.15e-04)	Tok/s 35277 (33564)	Loss/tok 9.2876 (9.9104)	LR 8.873e-05
4: TRAIN [0][20/26]	Time 1.147 (0.898)	Data 2.21e-04 (2.31e-04)	Tok/s 35687 (33976)	Loss/tok 8.8244 (9.5122)	LR 3.438e-04
7: TRAIN [0][20/26]	Time 1.147 (0.898)	Data 2.90e-04 (2.87e-04)	Tok/s 35657 (33987)	Loss/tok 8.8466 (9.5137)	LR 3.438e-04
1: TRAIN [0][20/26]	Time 1.147 (0.898)	Data 1.98e-04 (2.29e-04)	Tok/s 35456 (33873)	Loss/tok 8.8520 (9.5147)	LR 3.438e-04
6: TRAIN [0][20/26]	Time 1.147 (0.898)	Data 2.35e-04 (2.43e-04)	Tok/s 35380 (33963)	Loss/tok 8.8385 (9.5129)	LR 3.438e-04
5: TRAIN [0][20/26]	Time 1.147 (0.898)	Data 3.03e-04 (2.70e-04)	Tok/s 35636 (33979)	Loss/tok 8.8431 (9.5122)	LR 3.438e-04
0: TRAIN [0][20/26]	Time 1.147 (0.898)	Data 2.07e-04 (2.26e-04)	Tok/s 35377 (33866)	Loss/tok 8.8468 (9.5170)	LR 3.438e-04
2: TRAIN [0][20/26]	Time 1.147 (0.898)	Data 2.52e-04 (2.21e-04)	Tok/s 35730 (33862)	Loss/tok 8.8113 (9.5136)	LR 3.438e-04
3: TRAIN [0][20/26]	Time 1.147 (0.898)	Data 2.16e-04 (2.29e-04)	Tok/s 35552 (33866)	Loss/tok 8.8179 (9.5128)	LR 3.438e-04
0: Running validation on dev set
4: Running validation on dev set
2: Running validation on dev set
3: Running validation on dev set
6: Running validation on dev set
1: Running validation on dev set
5: Running validation on dev set
0: Executing preallocation
4: Executing preallocation
7: Running validation on dev set
2: Executing preallocation
1: Executing preallocation
3: Executing preallocation
6: Executing preallocation
5: Executing preallocation
7: Executing preallocation
7: VALIDATION [0][0/20]	Time 0.054 (0.000)	Data 1.24e-03 (0.00e+00)	Tok/s 67971 (0)	Loss/tok 9.8383 (9.8383)
6: VALIDATION [0][0/20]	Time 0.057 (0.000)	Data 1.29e-03 (0.00e+00)	Tok/s 65928 (0)	Loss/tok 9.7248 (9.7248)
5: VALIDATION [0][0/20]	Time 0.058 (0.000)	Data 1.23e-03 (0.00e+00)	Tok/s 66866 (0)	Loss/tok 9.8870 (9.8870)
4: VALIDATION [0][0/20]	Time 0.061 (0.000)	Data 1.07e-03 (0.00e+00)	Tok/s 65622 (0)	Loss/tok 9.7008 (9.7008)
3: VALIDATION [0][0/20]	Time 0.061 (0.000)	Data 1.07e-03 (0.00e+00)	Tok/s 68069 (0)	Loss/tok 9.8378 (9.8378)
2: VALIDATION [0][0/20]	Time 0.069 (0.000)	Data 1.31e-03 (0.00e+00)	Tok/s 64368 (0)	Loss/tok 9.8749 (9.8749)
1: VALIDATION [0][0/20]	Time 0.074 (0.000)	Data 1.39e-03 (0.00e+00)	Tok/s 64337 (0)	Loss/tok 9.8655 (9.8655)
0: VALIDATION [0][0/20]	Time 0.106 (0.000)	Data 1.28e-03 (0.00e+00)	Tok/s 54105 (0)	Loss/tok 9.9252 (9.9252)
7: VALIDATION [0][10/20]	Time 0.026 (0.030)	Data 7.49e-04 (7.63e-04)	Tok/s 59569 (72579)	Loss/tok 9.0280 (9.5000)
6: VALIDATION [0][10/20]	Time 0.027 (0.031)	Data 7.71e-04 (8.01e-04)	Tok/s 57026 (71805)	Loss/tok 9.1283 (9.5070)
4: VALIDATION [0][10/20]	Time 0.026 (0.032)	Data 7.60e-04 (8.14e-04)	Tok/s 59746 (72290)	Loss/tok 9.1625 (9.5183)
5: VALIDATION [0][10/20]	Time 0.026 (0.032)	Data 7.22e-04 (7.61e-04)	Tok/s 58645 (70978)	Loss/tok 8.9846 (9.5110)
3: VALIDATION [0][10/20]	Time 0.027 (0.032)	Data 7.86e-04 (7.78e-04)	Tok/s 58278 (71147)	Loss/tok 9.0578 (9.5442)
2: VALIDATION [0][10/20]	Time 0.026 (0.033)	Data 8.26e-04 (7.98e-04)	Tok/s 60502 (71686)	Loss/tok 9.3191 (9.5419)
1: VALIDATION [0][10/20]	Time 0.024 (0.032)	Data 7.75e-04 (8.04e-04)	Tok/s 67748 (73240)	Loss/tok 9.0800 (9.5543)
0: VALIDATION [0][10/20]	Time 0.024 (0.033)	Data 7.24e-04 (7.78e-04)	Tok/s 67478 (72962)	Loss/tok 9.2034 (9.5777)
0: Saving model to gnmt/model_best.pth
0: Running evaluation on test set
3: Running evaluation on test set
2: Running evaluation on test set
5: Running evaluation on test set
7: Running evaluation on test set
4: Running evaluation on test set
6: Running evaluation on test set
1: Running evaluation on test set
7: TEST [0][9/12]	Time 0.5169 (0.6808)	Decoder iters 149.0 (149.0)	Tok/s 2109 (6990)
2: TEST [0][9/12]	Time 0.5190 (0.6809)	Decoder iters 149.0 (149.0)	Tok/s 3162 (7513)
5: TEST [0][9/12]	Time 0.5169 (0.6808)	Decoder iters 149.0 (149.0)	Tok/s 1919 (7167)
3: TEST [0][9/12]	Time 0.5183 (0.6809)	Decoder iters 149.0 (149.0)	Tok/s 2510 (7276)
0: TEST [0][9/12]	Time 0.5197 (0.6809)	Decoder iters 149.0 (149.0)	Tok/s 3610 (7648)
1: TEST [0][9/12]	Time 0.5181 (0.6808)	Decoder iters 149.0 (149.0)	Tok/s 4671 (7757)
4: TEST [0][9/12]	Time 0.5168 (0.6808)	Decoder iters 149.0 (149.0)	Tok/s 3129 (7322)
6: TEST [0][9/12]	Time 0.5163 (0.6808)	Decoder iters 149.0 (149.0)	Tok/s 1869 (6988)
0: Running sacrebleu (parameters: --score-only -lc --tokenize intl)
2: Finished evaluation on test set
3: Finished evaluation on test set
0: Finished evaluation on test set
5: Finished evaluation on test set
1: Finished evaluation on test set
7: Finished evaluation on test set
6: Finished evaluation on test set
4: Finished evaluation on test set
0: Summary: Epoch: 0	Training Loss: 9.3135	Validation Loss: 9.3138	Test BLEU: 0.01
0: Performance: Epoch: 0	Training: 272432 Tok/s	Validation: 524864 Tok/s
0: Finished epoch 0
2: Finished epoch 0
3: Finished epoch 0
0: Starting epoch 1
2: Starting epoch 1
3: Starting epoch 1
1: Finished epoch 0
1: Starting epoch 1
2: Executing preallocation
5: Finished epoch 0
0: Executing preallocation
3: Executing preallocation
5: Starting epoch 1
7: Finished epoch 0
7: Starting epoch 1
4: Finished epoch 0
6: Finished epoch 0
4: Starting epoch 1
6: Starting epoch 1
1: Executing preallocation
5: Executing preallocation
7: Executing preallocation
6: Executing preallocation
4: Executing preallocation
0: Sampler for epoch 1 uses seed 2258090960
1: Sampler for epoch 1 uses seed 2258090960
2: Sampler for epoch 1 uses seed 2258090960
4: Sampler for epoch 1 uses seed 2258090960
3: Sampler for epoch 1 uses seed 2258090960
5: Sampler for epoch 1 uses seed 2258090960
6: Sampler for epoch 1 uses seed 2258090960
7: Sampler for epoch 1 uses seed 2258090960
0: TRAIN [1][0/26]	Time 1.028 (0.000)	Data 1.26e-01 (0.00e+00)	Tok/s 28414 (0)	Loss/tok 8.5101 (8.5101)	LR 7.749e-04
2: TRAIN [1][0/26]	Time 1.022 (0.000)	Data 1.35e-01 (0.00e+00)	Tok/s 28562 (0)	Loss/tok 8.5211 (8.5211)	LR 7.749e-04
1: TRAIN [1][0/26]	Time 1.022 (0.000)	Data 1.37e-01 (0.00e+00)	Tok/s 28625 (0)	Loss/tok 8.5204 (8.5204)	LR 7.749e-04
3: TRAIN [1][0/26]	Time 0.994 (0.000)	Data 1.36e-01 (0.00e+00)	Tok/s 29267 (0)	Loss/tok 8.4969 (8.4969)	LR 7.749e-04
7: TRAIN [1][0/26]	Time 0.982 (0.000)	Data 1.54e-01 (0.00e+00)	Tok/s 29839 (0)	Loss/tok 8.5115 (8.5115)	LR 7.749e-04
6: TRAIN [1][0/26]	Time 0.990 (0.000)	Data 1.50e-01 (0.00e+00)	Tok/s 29295 (0)	Loss/tok 8.5117 (8.5117)	LR 7.749e-04
5: TRAIN [1][0/26]	Time 1.019 (0.000)	Data 1.61e-01 (0.00e+00)	Tok/s 28500 (0)	Loss/tok 8.5464 (8.5464)	LR 7.749e-04
4: TRAIN [1][0/26]	Time 1.010 (0.000)	Data 1.54e-01 (0.00e+00)	Tok/s 28787 (0)	Loss/tok 8.5066 (8.5066)	LR 7.749e-04
1: TRAIN [1][10/26]	Time 1.146 (0.860)	Data 2.05e-04 (2.05e-04)	Tok/s 35486 (32259)	Loss/tok 7.9800 (8.0936)	LR 1.000e-03
3: TRAIN [1][10/26]	Time 1.145 (0.860)	Data 2.27e-04 (2.31e-04)	Tok/s 35264 (32242)	Loss/tok 7.9811 (8.1004)	LR 1.000e-03
0: TRAIN [1][10/26]	Time 1.145 (0.860)	Data 2.22e-04 (2.33e-04)	Tok/s 35605 (32313)	Loss/tok 7.9748 (8.0867)	LR 1.000e-03
6: TRAIN [1][10/26]	Time 1.145 (0.860)	Data 2.36e-04 (2.44e-04)	Tok/s 35424 (32394)	Loss/tok 7.9438 (8.0860)	LR 1.000e-03
7: TRAIN [1][10/26]	Time 1.145 (0.860)	Data 2.67e-04 (2.28e-04)	Tok/s 35607 (32264)	Loss/tok 8.0035 (8.0919)	LR 1.000e-03
2: TRAIN [1][10/26]	Time 1.146 (0.860)	Data 2.26e-04 (2.32e-04)	Tok/s 35573 (32421)	Loss/tok 7.9858 (8.0897)	LR 1.000e-03
4: TRAIN [1][10/26]	Time 1.145 (0.860)	Data 2.31e-04 (2.37e-04)	Tok/s 35523 (32354)	Loss/tok 7.9800 (8.0914)	LR 1.000e-03
5: TRAIN [1][10/26]	Time 1.145 (0.860)	Data 2.68e-04 (2.46e-04)	Tok/s 35641 (32273)	Loss/tok 7.9898 (8.0976)	LR 1.000e-03
0: TRAIN [1][20/26]	Time 1.150 (1.008)	Data 2.18e-04 (2.30e-04)	Tok/s 35444 (32042)	Loss/tok 7.7829 (7.9335)	LR 1.250e-04
3: TRAIN [1][20/26]	Time 1.150 (1.008)	Data 2.16e-04 (2.29e-04)	Tok/s 35447 (32009)	Loss/tok 7.8342 (7.9447)	LR 1.250e-04
1: TRAIN [1][20/26]	Time 1.150 (1.008)	Data 2.21e-04 (2.14e-04)	Tok/s 35515 (32060)	Loss/tok 7.7664 (7.9330)	LR 1.250e-04
2: TRAIN [1][20/26]	Time 1.150 (1.008)	Data 2.19e-04 (2.29e-04)	Tok/s 35385 (32099)	Loss/tok 7.7446 (7.9307)	LR 1.250e-04
6: TRAIN [1][20/26]	Time 1.150 (1.008)	Data 2.61e-04 (2.41e-04)	Tok/s 35586 (32128)	Loss/tok 7.8009 (7.9370)	LR 1.250e-04
7: TRAIN [1][20/26]	Time 1.150 (1.008)	Data 2.40e-04 (2.42e-04)	Tok/s 35247 (32012)	Loss/tok 7.7975 (7.9335)	LR 1.250e-04
5: TRAIN [1][20/26]	Time 1.150 (1.008)	Data 2.43e-04 (2.40e-04)	Tok/s 35372 (32067)	Loss/tok 7.7753 (7.9375)	LR 1.250e-04
4: TRAIN [1][20/26]	Time 1.150 (1.008)	Data 2.45e-04 (2.35e-04)	Tok/s 35295 (32055)	Loss/tok 7.8023 (7.9377)	LR 1.250e-04
Traceback (most recent call last):
  File "train.py", line 667, in <module>
    main()
  File "train.py", line 592, in main
    train_loss, train_perf = trainer.optimize(train_loader)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 352, in optimize
    output = self.feed_data(data_loader, training=True)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 236, in feed_data
    stats = self.iterate(src, tgt, update, training=training)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 191, in iterate
    self.fp_optimizer.step(loss, self.optimizer, self.scheduler,
  File "/workspace/examples/gnmt/seq2seq/train/fp_optimizers.py", line 181, in step
    loss.backward()
  File "/opt/conda/lib/python3.8/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/opt/conda/lib/python3.8/site-packages/torch/autograd/__init__.py", line 145, in backward
    Variable._execution_engine.run_backward(
RuntimeError: CUDA out of memory. Tried to allocate 3.76 GiB (GPU 1; 44.56 GiB total capacity; 32.12 GiB already allocated; 1.67 GiB free; 41.33 GiB reserved in total by PyTorch)
Traceback (most recent call last):
  File "train.py", line 667, in <module>
    main()
  File "train.py", line 592, in main
Traceback (most recent call last):
  File "train.py", line 667, in <module>
    train_loss, train_perf = trainer.optimize(train_loader)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 352, in optimize
Traceback (most recent call last):
    output = self.feed_data(data_loader, training=True)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 236, in feed_data
    stats = self.iterate(src, tgt, update, training=training)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 191, in iterate
  File "train.py", line 667, in <module>
    self.fp_optimizer.step(loss, self.optimizer, self.scheduler,
  File "/workspace/examples/gnmt/seq2seq/train/fp_optimizers.py", line 181, in step
    main()
  File "train.py", line 592, in main
    loss.backward()
  File "/opt/conda/lib/python3.8/site-packages/torch/tensor.py", line 245, in backward
    train_loss, train_perf = trainer.optimize(train_loader)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 352, in optimize
    main()
  File "train.py", line 592, in main
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/opt/conda/lib/python3.8/site-packages/torch/autograd/__init__.py", line 145, in backward
    output = self.feed_data(data_loader, training=True)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 236, in feed_data
    train_loss, train_perf = trainer.optimize(train_loader)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 352, in optimize
    Variable._execution_engine.run_backward(
    stats = self.iterate(src, tgt, update, training=training)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 191, in iterate
RuntimeError: CUDA out of memory. Tried to allocate 3.76 GiB (GPU 3; 44.56 GiB total capacity; 32.13 GiB already allocated; 1.65 GiB free; 41.33 GiB reserved in total by PyTorch)
    self.fp_optimizer.step(loss, self.optimizer, self.scheduler,
  File "/workspace/examples/gnmt/seq2seq/train/fp_optimizers.py", line 181, in step
    output = self.feed_data(data_loader, training=True)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 236, in feed_data
    loss.backward()
  File "/opt/conda/lib/python3.8/site-packages/torch/tensor.py", line 245, in backward
    stats = self.iterate(src, tgt, update, training=training)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 191, in iterate
    self.fp_optimizer.step(loss, self.optimizer, self.scheduler,
  File "/workspace/examples/gnmt/seq2seq/train/fp_optimizers.py", line 181, in step
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/opt/conda/lib/python3.8/site-packages/torch/autograd/__init__.py", line 145, in backward
    loss.backward()
  File "/opt/conda/lib/python3.8/site-packages/torch/tensor.py", line 245, in backward
    Variable._execution_engine.run_backward(
RuntimeError: CUDA out of memory. Tried to allocate 3.76 GiB (GPU 0; 44.56 GiB total capacity; 32.13 GiB already allocated; 1.66 GiB free; 41.33 GiB reserved in total by PyTorch)
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/opt/conda/lib/python3.8/site-packages/torch/autograd/__init__.py", line 145, in backward
    Variable._execution_engine.run_backward(
RuntimeError: CUDA out of memory. Tried to allocate 3.76 GiB (GPU 4; 44.56 GiB total capacity; 32.13 GiB already allocated; 1.65 GiB free; 41.33 GiB reserved in total by PyTorch)
Traceback (most recent call last):
  File "train.py", line 667, in <module>
    main()
  File "train.py", line 592, in main
    train_loss, train_perf = trainer.optimize(train_loader)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 352, in optimize
    output = self.feed_data(data_loader, training=True)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 236, in feed_data
    stats = self.iterate(src, tgt, update, training=training)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 191, in iterate
    self.fp_optimizer.step(loss, self.optimizer, self.scheduler,
  File "/workspace/examples/gnmt/seq2seq/train/fp_optimizers.py", line 181, in step
    loss.backward()
  File "/opt/conda/lib/python3.8/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/opt/conda/lib/python3.8/site-packages/torch/autograd/__init__.py", line 145, in backward
    Variable._execution_engine.run_backward(
RuntimeError: CUDA out of memory. Tried to allocate 3.76 GiB (GPU 7; 44.56 GiB total capacity; 32.14 GiB already allocated; 1.67 GiB free; 41.33 GiB reserved in total by PyTorch)
Traceback (most recent call last):
  File "train.py", line 667, in <module>
    main()
  File "train.py", line 592, in main
    train_loss, train_perf = trainer.optimize(train_loader)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 352, in optimize
    output = self.feed_data(data_loader, training=True)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 236, in feed_data
    stats = self.iterate(src, tgt, update, training=training)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 191, in iterate
    self.fp_optimizer.step(loss, self.optimizer, self.scheduler,
  File "/workspace/examples/gnmt/seq2seq/train/fp_optimizers.py", line 181, in step
    loss.backward()
  File "/opt/conda/lib/python3.8/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/opt/conda/lib/python3.8/site-packages/torch/autograd/__init__.py", line 145, in backward
    Variable._execution_engine.run_backward(
RuntimeError: CUDA out of memory. Tried to allocate 3.76 GiB (GPU 6; 44.56 GiB total capacity; 32.13 GiB already allocated; 1.65 GiB free; 41.33 GiB reserved in total by PyTorch)
Traceback (most recent call last):
  File "train.py", line 667, in <module>
    main()
  File "train.py", line 592, in main
    train_loss, train_perf = trainer.optimize(train_loader)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 352, in optimize
    output = self.feed_data(data_loader, training=True)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 236, in feed_data
    stats = self.iterate(src, tgt, update, training=training)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 191, in iterate
    self.fp_optimizer.step(loss, self.optimizer, self.scheduler,
  File "/workspace/examples/gnmt/seq2seq/train/fp_optimizers.py", line 181, in step
    loss.backward()
  File "/opt/conda/lib/python3.8/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/opt/conda/lib/python3.8/site-packages/torch/autograd/__init__.py", line 145, in backward
    Variable._execution_engine.run_backward(
RuntimeError: CUDA out of memory. Tried to allocate 3.76 GiB (GPU 2; 44.56 GiB total capacity; 32.14 GiB already allocated; 1.65 GiB free; 41.33 GiB reserved in total by PyTorch)
Traceback (most recent call last):
  File "train.py", line 667, in <module>
    main()
  File "train.py", line 592, in main
    train_loss, train_perf = trainer.optimize(train_loader)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 352, in optimize
    output = self.feed_data(data_loader, training=True)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 236, in feed_data
    stats = self.iterate(src, tgt, update, training=training)
  File "/workspace/examples/gnmt/seq2seq/train/trainer.py", line 191, in iterate
    self.fp_optimizer.step(loss, self.optimizer, self.scheduler,
  File "/workspace/examples/gnmt/seq2seq/train/fp_optimizers.py", line 181, in step
    loss.backward()
  File "/opt/conda/lib/python3.8/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/opt/conda/lib/python3.8/site-packages/torch/autograd/__init__.py", line 145, in backward
    Variable._execution_engine.run_backward(
RuntimeError: CUDA out of memory. Tried to allocate 3.76 GiB (GPU 5; 44.56 GiB total capacity; 32.13 GiB already allocated; 1.65 GiB free; 41.33 GiB reserved in total by PyTorch)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/opt/conda/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py", line 340, in <module>
    main()
  File "/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py", line 326, in main
    sigkill_handler(signal.SIGTERM, None)  # not coming back
  File "/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py", line 301, in sigkill_handler
    raise subprocess.CalledProcessError(returncode=last_return_code, cmd=cmd)
subprocess.CalledProcessError: Command '['/opt/conda/bin/python3', '-u', 'train.py', '--local_rank=7', '--dataset-dir', '/data/gnmt/wmt16_de_en', '--train-batch-size', '648', '--val-batch-size', '32', '--test-batch-size', '32', '--math', 'fp32', '--epochs', '2', '--seed', '2']' returned non-zero exit status 1.
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
Killing subprocess 401
Killing subprocess 402
Killing subprocess 403
Killing subprocess 404
Killing subprocess 405
Killing subprocess 406
Killing subprocess 407
Killing subprocess 408
DONE!
