:::NVLOGv0.1.0 ncf 1638425429.754128218 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.755434513 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.760155439 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.763942957 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.765264273 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.768924236 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.774463177 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.783377409 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.788130999 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.789188385 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.789783239 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.799708128 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.800076962 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.800628662 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.815031052 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.821006298 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.822798252 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.825621367 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.827951431 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.832288027 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.832667112 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.837273359 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.846121073 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.848298311 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.856780767 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.857363939 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.867217302 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.875872374 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.883508205 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.884831429 (ncf.py:171) cpu_info: {"num": 64, "name": "AMD EPYC 7502 32-Core Processor"}
:::NVLOGv0.1.0 ncf 1638425429.893183708 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425429.893368721 (ncf.py:171) mem_info: {"ram": "503Gi"}
:::NVLOGv0.1.0 ncf 1638425453.678828716 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425453.679247618 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425453.736981392 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425453.741083622 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425454.216607332 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425454.247671604 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425454.299878836 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425454.497305870 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425454.588616848 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425454.608738422 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425454.627362490 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425454.676549673 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425454.693886042 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425454.698443890 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425454.721838474 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425454.722457647 (ncf.py:171) gpu_info: {"driver_version": "470.63.01", "num": 16, "name": ["NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000", "NVIDIA RTX A4000"], "mem": ["16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB", "16117 MiB"]}
:::NVLOGv0.1.0 ncf 1638425464.978919983 (ncf.py:174) args: {"data": "/data/ncf/cache/ml-20m", "epochs": 2, "batch_size": 44800000, "valid_batch_size": 1048576, "factors": 64, "layers": [256, 256, 128, 64], "negative_samples": 4, "learning_rate": 0.0045, "topk": 10, "seed": 1, "threshold": 1.0, "beta1": 0.25, "beta2": 0.5, "eps": 1e-08, "dropout": 0.5, "checkpoint_dir": "/data/checkpoints/", "load_checkpoint_path": null, "mode": "train", "grads_accumulated": 1, "opt_level": "O2", "local_rank": 0, "distributed": true, "world_size": 16}
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425464.978919983 (ncf.py:174) args: {"data": "/data/ncf/cache/ml-20m", "epochs": 2, "batch_size": 44800000, "valid_batch_size": 1048576, "factors": 64, "layers": [256, 256, 128, 64], "negative_samples": 4, "learning_rate": 0.0045, "topk": 10, "seed": 1, "threshold": 1.0, "beta1": 0.25, "beta2": 0.5, "eps": 1e-08, "dropout": 0.5, "checkpoint_dir": "/data/checkpoints/", "load_checkpoint_path": null, "mode": "train", "grads_accumulated": 1, "opt_level": "O2", "local_rank": 0, "distributed": true, "world_size": 16}
Saving results to /data/checkpoints/
:::NVLOGv0.1.0 ncf 1638425464.980089188 (ncf.py:184) preproc_hp_sample_eval_replacement: true
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425464.980089188 (ncf.py:184) preproc_hp_sample_eval_replacement: true
:::NVLOGv0.1.0 ncf 1638425464.980659723 (ncf.py:185) input_hp_sample_train_replacement: true
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425464.980659723 (ncf.py:185) input_hp_sample_train_replacement: true
:::NVLOGv0.1.0 ncf 1638425464.981241941 (ncf.py:186) input_step_eval_neg_gen
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425464.981241941 (ncf.py:186) input_step_eval_neg_gen
:::NVLOGv0.1.0 ncf 1638425473.948361158 (ncf.py:194) run_start
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425473.948361158 (ncf.py:194) run_start
:::NVLOGv0.1.0 ncf 1638425474.234932661 (ncf.py:201) preproc_hp_num_eval: 100
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425474.234932661 (ncf.py:201) preproc_hp_num_eval: 100
:::NVLOGv0.1.0 ncf 1638425474.236587763 (ncf.py:207) input_size: 19861770
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425474.236587763 (ncf.py:207) input_size: 19861770
:::NVLOGv0.1.0 ncf 1638425474.373106241 (ncf.py:216) input_batch_size: 44800000
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425474.373106241 (ncf.py:216) input_batch_size: 44800000
:::NVLOGv0.1.0 ncf 1638425474.373746634 (ncf.py:217) input_order
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425474.373746634 (ncf.py:217) input_order
:::NVLOGv0.1.0 ncf 1638425474.374909163 (/workspace/examples/ncf/neumf.py:54) model_hp_mf_dim: 64
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425474.374909163 (/workspace/examples/ncf/neumf.py:54) model_hp_mf_dim: 64
:::NVLOGv0.1.0 ncf 1638425474.566879272 (/workspace/examples/ncf/neumf.py:62) model_hp_mlp_layer_sizes: [256, 256, 128, 64]
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425474.566879272 (/workspace/examples/ncf/neumf.py:62) model_hp_mlp_layer_sizes: [256, 256, 128, 64]
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : False
master_weights         : True
loss_scale             : dynamic
DistributedDataParallel(
  (module): NeuMF(
    (mf_user_embed): Embedding(138493, 64)
    (mf_item_embed): Embedding(26744, 64)
    (mlp_user_embed): Embedding(138493, 128)
    (mlp_item_embed): Embedding(26744, 128)
    (mlp): ModuleList(
      (0): Linear(in_features=256, out_features=256, bias=True)
      (1): Linear(in_features=256, out_features=128, bias=True)
      (2): Linear(in_features=128, out_features=64, bias=True)
    )
    (final): Linear(in_features=128, out_features=1, bias=True)
  )
)
31832577 parameters
:::NVLOGv0.1.0 ncf 1638425475.140566349 (ncf.py:246) opt_learning_rate: 0.0045
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425475.140566349 (ncf.py:246) opt_learning_rate: 0.0045
:::NVLOGv0.1.0 ncf 1638425475.140996456 (ncf.py:247) opt_name: "Adam"
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425475.140996456 (ncf.py:247) opt_name: "Adam"
:::NVLOGv0.1.0 ncf 1638425475.141247988 (ncf.py:248) opt_hp_Adam_beta1: 0.25
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425475.141247988 (ncf.py:248) opt_hp_Adam_beta1: 0.25
:::NVLOGv0.1.0 ncf 1638425475.141495228 (ncf.py:249) opt_hp_Adam_beta2: 0.5
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425475.141495228 (ncf.py:249) opt_hp_Adam_beta2: 0.5
:::NVLOGv0.1.0 ncf 1638425475.141769648 (ncf.py:250) opt_hp_Adam_epsilon: 1e-08
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425475.141769648 (ncf.py:250) opt_hp_Adam_epsilon: 1e-08
:::NVLOGv0.1.0 ncf 1638425475.142030954 (ncf.py:251) model_hp_loss_fn: "binary_cross_entropy"
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425475.142030954 (ncf.py:251) model_hp_loss_fn: "binary_cross_entropy"
:::NVLOGv0.1.0 ncf 1638425475.142275572 (ncf.py:279) train_loop
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425475.142275572 (ncf.py:279) train_loop
:::NVLOGv0.1.0 ncf 1638425475.142523766 (ncf.py:282) train_epoch_start: 0
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425475.142523766 (ncf.py:282) train_epoch_start: 0
:::NVLOGv0.1.0 ncf 1638425475.142766953 (ncf.py:283) input_hp_num_neg: 4
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425475.142766953 (ncf.py:283) input_hp_num_neg: 4
:::NVLOGv0.1.0 ncf 1638425475.143004656 (ncf.py:284) input_step_train_neg_gen
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425475.143004656 (ncf.py:284) input_step_train_neg_gen
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
:::NVLOGv0.1.0 ncf 1638425479.625031471 (ncf.py:318) train_throughput: 22160081.512627978
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425479.625031471 (ncf.py:318) train_throughput: 22160081.512627978
:::NVLOGv0.1.0 ncf 1638425479.625457525 (ncf.py:319) train_epoch_stop: 0
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425479.625457525 (ncf.py:319) train_epoch_stop: 0
:::NVLOGv0.1.0 ncf 1638425479.625720501 (ncf.py:320) eval_start: 0
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425479.625720501 (ncf.py:320) eval_start: 0
ncf.py:146: UserWarning: indexing with dtype torch.uint8 is now deprecated, please use a dtype torch.bool instead. (Triggered internally at  ../aten/src/ATen/native/IndexingUtils.h:29.)
  temp[dup_mask] = -1
:::NVLOGv0.1.0 ncf 1638425479.668222904 (ncf.py:155) eval_size: {"epoch": 0, "value": 13987793}
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425479.668222904 (ncf.py:155) eval_size: {"epoch": 0, "value": 13987793}
:::NVLOGv0.1.0 ncf 1638425479.668960333 (ncf.py:156) eval_hp_num_users: 138493
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425479.668960333 (ncf.py:156) eval_hp_num_users: 138493
:::NVLOGv0.1.0 ncf 1638425479.669602871 (ncf.py:157) eval_hp_num_neg: 100
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425479.669602871 (ncf.py:157) eval_hp_num_neg: 100
/opt/conda/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py:144: UserWarning: torch.distributed.reduce_op is deprecated, please use torch.distributed.ReduceOp instead
  warnings.warn("torch.distributed.reduce_op is deprecated, please use "
Epoch 0: HR@10 = 0.0385, NDCG@10 = 0.0233, train_time = 4.48, val_time = 0.05
:::NVLOGv0.1.0 ncf 1638425479.676977634 (ncf.py:333) eval_accuracy: {"epoch": 0, "value": 0.03848569963824886}
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425479.676977634 (ncf.py:333) eval_accuracy: {"epoch": 0, "value": 0.03848569963824886}
:::NVLOGv0.1.0 ncf 1638425479.677570343 (ncf.py:334) eval_target: 1.0
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425479.677570343 (ncf.py:334) eval_target: 1.0
:::NVLOGv0.1.0 ncf 1638425479.678160429 (ncf.py:335) eval_stop: 0
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425479.678160429 (ncf.py:335) eval_stop: 0
:::NVLOGv0.1.0 ncf 1638425479.678424597 (ncf.py:340) eval_throughput: 269321778.0530298
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425479.678424597 (ncf.py:340) eval_throughput: 269321778.0530298
New best hr! Saving the model to:  /data/checkpoints/model.pth
:::NVLOGv0.1.0 ncf 1638425480.005028963 (ncf.py:282) train_epoch_start: 1
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.005028963 (ncf.py:282) train_epoch_start: 1
:::NVLOGv0.1.0 ncf 1638425480.005661964 (ncf.py:283) input_hp_num_neg: 4
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.005661964 (ncf.py:283) input_hp_num_neg: 4
:::NVLOGv0.1.0 ncf 1638425480.006216764 (ncf.py:284) input_step_train_neg_gen
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.006216764 (ncf.py:284) input_step_train_neg_gen
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
:::NVLOGv0.1.0 ncf 1638425480.487209320 (ncf.py:318) train_throughput: 206619307.4438338
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.487209320 (ncf.py:318) train_throughput: 206619307.4438338
:::NVLOGv0.1.0 ncf 1638425480.487495184 (ncf.py:319) train_epoch_stop: 1
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.487495184 (ncf.py:319) train_epoch_stop: 1
:::NVLOGv0.1.0 ncf 1638425480.487753630 (ncf.py:320) eval_start: 1
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.487753630 (ncf.py:320) eval_start: 1
:::NVLOGv0.1.0 ncf 1638425480.517055035 (ncf.py:155) eval_size: {"epoch": 1, "value": 13987793}
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.517055035 (ncf.py:155) eval_size: {"epoch": 1, "value": 13987793}
:::NVLOGv0.1.0 ncf 1638425480.517361164 (ncf.py:156) eval_hp_num_users: 138493
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.517361164 (ncf.py:156) eval_hp_num_users: 138493
:::NVLOGv0.1.0 ncf 1638425480.517647982 (ncf.py:157) eval_hp_num_neg: 100
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.517647982 (ncf.py:157) eval_hp_num_neg: 100
Epoch 1: HR@10 = 0.7169, NDCG@10 = 0.4259, train_time = 0.48, val_time = 0.03
:::NVLOGv0.1.0 ncf 1638425480.519363165 (ncf.py:333) eval_accuracy: {"epoch": 1, "value": 0.7168809975955464}
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.519363165 (ncf.py:333) eval_accuracy: {"epoch": 1, "value": 0.7168809975955464}
:::NVLOGv0.1.0 ncf 1638425480.519644976 (ncf.py:334) eval_target: 1.0
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.519644976 (ncf.py:334) eval_target: 1.0
:::NVLOGv0.1.0 ncf 1638425480.519911528 (ncf.py:335) eval_stop: 1
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.519911528 (ncf.py:335) eval_stop: 1
:::NVLOGv0.1.0 ncf 1638425480.520169258 (ncf.py:340) eval_throughput: 435540563.9852714
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.520169258 (ncf.py:340) eval_throughput: 435540563.9852714
New best hr! Saving the model to:  /data/checkpoints/model.pth
:::NVLOGv0.1.0 ncf 1638425480.845198870 (ncf.py:356) best_train_throughput: 206619307.4438338
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.845198870 (ncf.py:356) best_train_throughput: 206619307.4438338
:::NVLOGv0.1.0 ncf 1638425480.845894814 (ncf.py:357) best_eval_throughput: 435540563.9852714
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.845894814 (ncf.py:357) best_eval_throughput: 435540563.9852714
:::NVLOGv0.1.0 ncf 1638425480.846449614 (ncf.py:358) best_accuracy: 0.7168809975955464
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.846449614 (ncf.py:358) best_accuracy: 0.7168809975955464
:::NVLOGv0.1.0 ncf 1638425480.847011089 (ncf.py:359) time_to_target: 6.898611783981323
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.847011089 (ncf.py:359) time_to_target: 6.898611783981323
:::NVLOGv0.1.0 ncf 1638425480.847562790 (ncf.py:360) time_to_best_model: 6.896547794342041
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.847562790 (ncf.py:360) time_to_best_model: 6.896547794342041
:::NVLOGv0.1.0 ncf 1638425480.848819494 (ncf.py:362) run_stop: {"success": false}
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.848819494 (ncf.py:362) run_stop: {"success": false}
:::NVLOGv0.1.0 ncf 1638425480.849347115 (ncf.py:363) run_final
DEBUG:nv_dl_logger::::NVLOGv0.1.0 ncf 1638425480.849347115 (ncf.py:363) run_final
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
DONE!
